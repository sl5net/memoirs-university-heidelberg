<html>
<title>Gesamtdoku vom 17. March 2005 10:03 Uhr - PHP-Loesung/html-statisch-momentaufnahme</title>
<head>
<script language="JavaScript">
function on_load(){
	//alert('hallo');
	with( document.forms[0] ){
		ele = elements[''];
		//alert(ele.name);
		if(ele){
			elements['bottom'].focus();
			ele.focus();
			// Zu focus() :
			// Setzt den Cursor bzw. den Focus auf das betreffende Element.
			// http://de.selfhtml.org/javascript/objekte/elements.htm#focus
			ele.blur();
			// Zu blur() : 
			// Und Element wieder verlassen damit man die Pos1/Ende/Bild- Tasten wieder verwenden kann.
			// http://de.selfhtml.org/javascript/objekte/elements.htm#blur
}	}	}
</script>
</head>
<body onload="on_load();"><form>
<div align="right">Gesamtdoku vom
17. March 2005 10:03 Uhr - PHP-Loesung/html-statisch-momentaufnahme</div>
<script language="JavaScript">if(external)document.write("<input type='Button' onclick=\"external.AddFavorite(location.protocol+'//'+location.host+'/[ScriptAdress]?f=[SitePath]/frameset.htm?url=[url *+*]', 'PHP-Loesung/html-statisch-momentaufnahme - index.php'  )\" value='Als Lesezeichen ablegen.'>");</script>
<br />
<b>Warning</b>:  fopen(../html-statisch-momentaufnahme.zip): failed to open stream: Permission denied in <b>/usr/local/pem/vhosts/16344/webspace/httpdocs/uni/dpprak_logbuch/Teil3/PHP-Loesung/html-statisch-momentaufnahme/index.php</b> on line <b>86</b><br />
<table border="0"><tr><td valign="top">Zu anderen Ordnern:<br><br><a href='../index.php'><i>Zurück zu: <b>PHP-Loesung</b></i></a>&nbsp;&nbsp;&nbsp;&nbsp; </td><br><td valign="top">ZIP-Files zum download:<ol><li><a href='../html-statisch-momentaufnahme.zip'>../html-statisch-momentaufnahme.zip</a> (enthällt Inhalt dieses Ordners)</li>
</ol></td></tr></table>Inhaltsverzeichnis der Dateien dieses Ordners:<ol><li><a href='index.php?f=aufgabe4.4.5_v0503082041.php&f_constant=1'>aufgabe4.4.5_v0503082041.php</a></li>
<li><a href='index.php?f=aufgabenliste.inc.php&f_constant=1'>aufgabenliste.inc.php</a></li>
</ol><ol><li>
  <table>
    <tr>
      <td rowspan="2">
	  <a name='aufgabe4.4.5_v0503082041.php'></a><input value="aufgabe4.4.5_v0503082041.php" onClick='this.select()'  onChange='on_change()' style="font: 150%;" size=28 name="aufgabe4.4.5_v0503082041.php">
	</td>
      <td><a href="#" accesskey="l"><u><b>l</b></u>ast</a></td>
      <td rowspan="2">
	  &nbsp;&nbsp;<a href='aufgabe4.4.5_v0503082041.php' target='_blank'>Script ausführen</a>
	  &nbsp;&nbsp;&nbsp;Zum Anfang mit <strong>Pos1-Taste</strong>
	  &nbsp;&nbsp;&nbsp;Zum Ende mit <strong>Ende-Taste</strong>
	  &nbsp;&nbsp;&nbsp;Seitenweise nach oben/unten mit <strong>Bild-Tasten</strong>
	  </td>
    </tr>
    <tr>
      <td><a href="#aufgabenliste.inc.php" accesskey="n"><u><b>n</b></u>ext</a></td>
    </tr>
  </table>
	<hr>Verwendete <strong>PHP-Funktinen</strong>: <a href='http://de.php.net/manual/de/function.echo.php' target='nachlese'>echo</a>, <a href='http://de.php.net/manual/de/function.include.php' target='nachlese'>include</a>, <a href='http://de.php.net/manual/de/function.preg-match.php' target='nachlese'>preg_match</a>, <a href='http://de.php.net/manual/de/function.phpinfo.php' target='nachlese'>phpinfo</a>, <a href='http://de.php.net/manual/de/function.while.php' target='nachlese'>while</a>, <a href='http://de.php.net/manual/de/function.return.php' target='nachlese'>return</a>, <a href='http://de.php.net/manual/de/function.file.php' target='nachlese'>file</a>, <a href='http://de.php.net/manual/de/function.time.php' target='nachlese'>time</a>, <a href='http://de.php.net/manual/de/function.count.php' target='nachlese'>count</a>, <a href='http://de.php.net/manual/de/function.implode.php' target='nachlese'>implode</a>, <a href='http://de.php.net/manual/de/function.explode.php' target='nachlese'>explode</a>, <a href='http://de.php.net/manual/de/function.foreach.php' target='nachlese'>foreach</a>, <a href='http://de.php.net/manual/de/function.array-keys.php' target='nachlese'>array_keys</a>, <a href='http://de.php.net/manual/de/function.array-values.php' target='nachlese'>array_values</a>, <a href='http://de.php.net/manual/de/function.print-r.php' target='nachlese'>print_r</a>, <a href='http://de.php.net/manual/de/function.substr.php' target='nachlese'>substr</a>, <a href='http://de.php.net/manual/de/function.preg-replace.php' target='nachlese'>preg_replace</a>, <a href='http://de.php.net/manual/de/function.rand.php' target='nachlese'>rand</a>, <a href='http://de.php.net/manual/de/function.isset.php' target='nachlese'>isset</a>, <a href='http://de.php.net/manual/de/function.unset.php' target='nachlese'>unset</a>, <a href='http://de.php.net/manual/de/function.htmlentities.php' target='nachlese'>htmlentities</a><br>Verwendete <strong>MySQL-Funktinen</strong>: <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=SELECT+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>SELECT</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=FROM+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>FROM</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=UPDATE+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>UPDATE</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=WHERE+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>WHERE</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=TRIM+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>TRIM</a><br>Verwendete <strong>HTML-Tags</strong>: <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Ctable%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;table&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Cbr%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;br&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Ctr%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;tr&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Ctd%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;td&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Cinput%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;input&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Ctextarea%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;textarea&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Cbody%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;body&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Cselect%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;select&gt;</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Cjavascript%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;javascript&gt;</a><br><br><code><font color="#000000">
&lt;html&gt;&lt;head&gt;<br />&lt;style type="text/css"&gt; <br />A &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ font-size: 11pt; text-decoration: none; } <br />A:Hover, A:Active &nbsp;&nbsp;&nbsp;&nbsp;{ font-size: 12pt; text-decoration: underline; color: black; }<br />&lt;/style&gt;<br />&lt;script language="JavaScript"&gt;<br />var backup_text, text_is_sql = true;<br />function show_text_in_form(t , s ){&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;set_backup();<br />&nbsp;&nbsp;&nbsp;&nbsp;document.forms[0].elements['sql'].value = t; <br />&nbsp;&nbsp;&nbsp;&nbsp;text_is_sql = false;<br />&nbsp;&nbsp;&nbsp;&nbsp;window.status = s;<br />&nbsp;&nbsp;&nbsp;&nbsp;//alert(s);<br />}<br />function load_backup(){ <br />&nbsp;&nbsp;&nbsp;&nbsp;if(!text_is_sql &amp;&amp; backup_text){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.forms[0].elements['sql'].value = backup_text; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_is_sql = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;//alert('load_backup'); <br />}<br />function set_backup(){&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if(text_is_sql) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with (document.forms[0].elements['sql'] ) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( value ){ backup_text = value; text_is_sql = true; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;//alert('set_backup'); <br />}<br />function on_load(){&nbsp;&nbsp;&nbsp;&nbsp;set_backup(); }<br />&lt;/script&gt;<br />&lt;/head&gt;&lt;body onload="on_load()"&gt;<br /><font color="#0000BB">&lt;?php<br /></font><font color="#FF8000"># htmlentities - auswahl anzeigen<br />#for( $i = 1 ; $i &lt; 999 ; $i++ ) {&nbsp;&nbsp;&nbsp;&nbsp;echo "&lt;font color='#b0b0b0'&gt;&amp;#38&amp;#35&lt;!-- --&gt;$i&lt;/font&gt; = &amp;#$i\n"; }<br /><br />#http://localhost/privat/sebastian_privat/begin_19aug04/protected/Projekte/Studium/dpprak_logbuch/Teil3/PHP-Loesung/aufgabe4.4.5_v0503082041.php<br /># Nun die komischen Slashes entfernen die beim versenden von Formularen oft automatsich erzeugt werden. Grrr.<br /># machen wir immer automatisch sofort, sobald nötig.<br /># echo "&lt;pre&gt;";print_r( $HTTP_POST_VARS );<br /></font><font color="#007700">if ( </font><font color="#0000BB">get_magic_quotes_gpc</font><font color="#007700">() ) {<br />&nbsp;&nbsp;</font><font color="#FF8000">// Really EGPCSR - Environment $_ENV, GET $_GET , POST $_POST, Cookie $_COOKIE, Server $_SERVER<br />&nbsp;&nbsp;// and their HTTP_*_VARS cousins (separate arrays, not references) and $_REQUEST<br />&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$fnStripMagicQuotes </font><font color="#007700">= </font><font color="#0000BB">create_function</font><font color="#007700">(</font><font color="#DD0000">'&amp;$mData, $fnSelf'</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'if (is_array($mData)) foreach ($mData as $mKey=&gt;$mValue) $fnSelf($mData[$mKey], $fnSelf); '</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'else $mData = stripslashes($mData);'</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//$fnStripMagicQuotes($_POST,$fnStripMagicQuotes);<br />&nbsp;&nbsp;&nbsp;&nbsp;// do each set of EGPCSR as you find necessary<br />&nbsp;&nbsp;&nbsp;&nbsp;#$fnStripMagicQuotes( $HTTP_POST_VARS , $fnStripMagicQuotes );<br />&nbsp;&nbsp;&nbsp;&nbsp;#$fnStripMagicQuotes( $HTTP_GET_VARS , $fnStripMagicQuotes );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$fnStripMagicQuotes</font><font color="#007700">( </font><font color="#0000BB">$sql </font><font color="#007700">, </font><font color="#0000BB">$fnStripMagicQuotes </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// do each set of EGPCSR as you find necessary<br /></font><font color="#007700">}<br /><br /><br /><br />if(!</font><font color="#0000BB">$table_name</font><font color="#007700">)</font><font color="#0000BB">$table_name </font><font color="#007700">= </font><font color="#DD0000">'BERG'</font><font color="#007700">;<br /></font><font color="#0000BB">$table_name </font><font color="#007700">= </font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">$table_name</font><font color="#007700">);<br /></font><font color="#0000BB">$default_sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT * FROM $table_name ORDER BY B_ID" </font><font color="#007700">;<br /></font><font color="#0000BB">?&gt;<br /></font>&lt;font size="-1"&gt;Aufgabe 4.4.5 Eine kleine Applikation&lt;/font&gt; - <br /><font color="#0000BB">&lt;?php<br /></font><font color="#FF8000"># $sql formatieren, damit es lesbarer ist.<br />#gelb($fromline.'»'.__LINE__,__FILE__, $sql, 'b' );<br /></font><font color="#007700">if( !</font><font color="#0000BB">$aufgabennr </font><font color="#007700">)</font><font color="#0000BB">pretty_sql</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br /></font><font color="#FF8000">#gelb($fromline.'»'.__LINE__,__FILE__, $sql, 'b' );<br /><br />#$hDB = odbc_connect('datenquelle','sasaus42','milchshake');<br /></font><font color="#007700">if( !</font><font color="#0000BB">$hDB </font><font color="#007700">= </font><font color="#0000BB">odbc_connect</font><font color="#007700">(</font><font color="#DD0000">'datenquelle'</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># odbc_connect - Liefert eine ODBC-Verbindungskennung connection_id oder 0 (FALSE) bei Fehlfunktion zurück.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#0000BB">odbc_errormsg</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">exit_in</font><font color="#007700">( </font><font color="#0000BB">__line__ </font><font color="#007700">);<br />}<br /></font><font color="#FF8000"># Verbindungsaufbau ok!<br /></font><font color="#007700">if (empty(</font><font color="#0000BB">$hDB</font><font color="#007700">)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"odbc_connect misslungen. (&lt;font size=-3&gt;$hDB&lt;/font&gt;)"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#0000BB">odbc_errormsg</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">exit_in</font><font color="#007700">( </font><font color="#0000BB">__line__ </font><font color="#007700">);<br />}<br /></font><font color="#FF8000">#phpinfo(); exit;<br /><br /></font><font color="#007700">echo </font><font color="#DD0000">"odbc_connect ok! (&lt;font size=-3&gt;$hDB&lt;/font&gt;)"</font><font color="#007700">;<br /><br /><br /></font><font color="#FF8000">######################################<br />#odbc_tables --&nbsp;&nbsp;Get the list of table names stored in a specific data source<br /></font><font color="#007700">if( </font><font color="#0000BB">1 </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Einfach Ausgabe aller Tabellen - Namen ...<br />&nbsp;&nbsp;&nbsp;&nbsp;# echo 'odbc_tables=' . odbc_result_all( odbc_tables( $hDB )&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$resource_tbl </font><font color="#007700">= </font><font color="#0000BB">odbc_tables</font><font color="#007700">( </font><font color="#0000BB">$hDB </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo '&lt;select name="" onchange="on_change(this.value)"&gt;';<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;br&gt;SELECT * FROM &lt;font size="-1"&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;while( </font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">odbc_fetch_assoc</font><font color="#007700">( </font><font color="#0000BB">$resource_tbl </font><font color="#007700">) ){ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$type </font><font color="#007700">= </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'TABLE_TYPE'</font><font color="#007700">] ;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$type </font><font color="#007700">== </font><font color="#DD0000">'SYSTEM TABLE' </font><font color="#007700">|| </font><font color="#0000BB">$type </font><font color="#007700">== </font><font color="#DD0000">'VIEW' </font><font color="#007700">) continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$tbl </font><font color="#007700">= </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'TABLE_NAME'</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></font><font color="#FF8000">/*<br />&nbsp;&nbsp;&nbsp;&nbsp;funktioniert<br />&nbsp;&nbsp;'TABLE_SCHEM' =&gt; 'SASAUS42',<br />&nbsp;&nbsp;'TABLE_NAME' =&gt; 'BENACHBART',<br />&nbsp;&nbsp;'TABLE_TYPE' =&gt; 'TABLE',<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funktioniert nicht<br />&nbsp;&nbsp;&nbsp;&nbsp;'TABLE_SCHEM' =&gt; 'SYSCAT',<br />&nbsp;&nbsp;'TABLE_NAME' =&gt; 'BUFFERPOOLDBPARTITIONS',<br />&nbsp;&nbsp;'TABLE_TYPE' =&gt; 'VIEW',<br />*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$tbl </font><font color="#007700">= </font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">$tbl</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#blau('$row:' ,'', $row );<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s </font><font color="#007700">= </font><font color="#DD0000">'SELECT * FROM ' </font><font color="#007700">. </font><font color="#0000BB">$tbl</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo '&lt;option value="'.$s.'"'.( ( trim($sql) == trim($s) ) ? ' selected':''&nbsp;&nbsp;&nbsp;).'&gt;'.$row['TABLE_NAME'].' : '.$s.'&lt;/option&gt;';<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$href_table </font><font color="#007700">= </font><font color="#DD0000">'&lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">.</font><font color="#DD0000">'?sql='</font><font color="#007700">. </font><font color="#0000BB">$s </font><font color="#007700">.</font><font color="#DD0000">'&amp;table_name='</font><font color="#007700">.</font><font color="#0000BB">$tbl</font><font color="#007700">.</font><font color="#DD0000">'" accesskey="'</font><font color="#007700">.</font><font color="#0000BB">substr</font><font color="#007700">(</font><font color="#0000BB">$tbl</font><font color="#007700">,</font><font color="#0000BB">0</font><font color="#007700">,</font><font color="#0000BB">1</font><font color="#007700">).</font><font color="#DD0000">'"&gt;'</font><font color="#007700">. </font><font color="#0000BB">$tbl </font><font color="#007700">.</font><font color="#DD0000">'&lt;/a&gt; '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$key_search </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Was wir hir wollen heißt unter MySql: SHOW FIELDS FROM table<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# So erhällt man auf einmal alle Struckturinformationen aller Tabellen auf einmal:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $res400= odbc_columns( $hDB ,"","",""); # Für uns aber unzweckmässig.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$rs </font><font color="#007700">= @</font><font color="#0000BB">odbc_exec</font><font color="#007700">( </font><font color="#0000BB">$hDB </font><font color="#007700">, </font><font color="#0000BB">$s</font><font color="#007700">. </font><font color="#DD0000">' FETCH FIRST 1 ROWS ONLY ' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">odbc_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">) ;&nbsp;&nbsp;&nbsp;&nbsp;unset(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">odbc_affected_rows</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( isset( </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">strtoupper</font><font color="#007700">( </font><font color="#0000BB">$key_search </font><font color="#007700">)] ) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Die Spalte kommt hier vor. Wir geben alle Spalten aus.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;table border="1" cellpadding="0" cellspacing="0"&gt;&lt;tr&gt;&lt;td colspan="'</font><font color="#007700">.</font><font color="#0000BB">count</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">).</font><font color="#DD0000">'"&gt;&lt;b&gt;'</font><font color="#007700">.</font><font color="#0000BB">$key_search</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;/b&gt; gefunden als Spalte der Tabelle '</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;b&gt;'</font><font color="#007700">.</font><font color="#0000BB">$href_table</font><font color="#007700">.</font><font color="#DD0000">'&lt;/b&gt;:&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach( </font><font color="#0000BB">array_keys</font><font color="#007700">( </font><font color="#0000BB">$row </font><font color="#007700">) AS </font><font color="#0000BB">$key </font><font color="#007700">) echo </font><font color="#0000BB">get_table_title</font><font color="#007700">( </font><font color="#0000BB">$key</font><font color="#007700">, </font><font color="#0000BB">$s</font><font color="#007700">, </font><font color="#0000BB">$tbl </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;/tr&gt;&lt;/table&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else echo </font><font color="#0000BB">$href_table</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else echo </font><font color="#0000BB">$href_table</font><font color="#007700">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">####################################<br />&nbsp;&nbsp;&nbsp;&nbsp;# Manuelle Links:<br />&nbsp;&nbsp;&nbsp;&nbsp;####################################<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;hr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;include( </font><font color="#DD0000">'aufgabenliste.inc.php' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;while( list( </font><font color="#0000BB">$k</font><font color="#007700">, </font><font color="#0000BB">$v </font><font color="#007700">) = </font><font color="#0000BB">each</font><font color="#007700">( </font><font color="#0000BB">$aufgaben_list </font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">echo_aufgabe</font><font color="#007700">( </font><font color="#0000BB">$k </font><font color="#007700">, </font><font color="#0000BB">$v</font><font color="#007700">[</font><font color="#0000BB">nr</font><font color="#007700">] , </font><font color="#0000BB">$v</font><font color="#007700">[</font><font color="#0000BB">text</font><font color="#007700">] , </font><font color="#0000BB">$v</font><font color="#007700">[</font><font color="#0000BB">sql</font><font color="#007700">] , </font><font color="#0000BB">$v</font><font color="#007700">[</font><font color="#0000BB">tbl</font><font color="#007700">]&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br />if( </font><font color="#0000BB">$aufgabennr </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[</font><font color="#0000BB">$aufgabennr</font><font color="#007700">][</font><font color="#0000BB">sql</font><font color="#007700">] ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$table_name </font><font color="#007700">= </font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[</font><font color="#0000BB">$aufgabennr</font><font color="#007700">][</font><font color="#0000BB">tbl</font><font color="#007700">] ;<br />}<br />if( !</font><font color="#0000BB">$sql </font><font color="#007700">) </font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#0000BB">$default_sql </font><font color="#007700">;<br /></font><font color="#FF8000"># Wir trennen die SQL bei ; auf. Das Zeichen sollte natürlich nicht anders verwendet werden.<br /></font><font color="#0000BB">$sql_array </font><font color="#007700">= </font><font color="#0000BB">explode</font><font color="#007700">( </font><font color="#DD0000">';' </font><font color="#007700">, </font><font color="#0000BB">$sql </font><font color="#007700">);<br />while( </font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#0000BB">trim</font><font color="#007700">(</font><font color="#0000BB">array_shift</font><font color="#007700">( </font><font color="#0000BB">$sql_array </font><font color="#007700">)) ){<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#if( $sql[0] == '#' ) continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;# odbc_exec - Liefert bei einem Fehler FALSE zurück, sonst eine ODBC-Ergebniskennung result_id. <br />&nbsp;&nbsp;&nbsp;&nbsp;# odbc_error - Returns a six-digit ODBC state, or an empty string if there has been no errors. <br />&nbsp;&nbsp;&nbsp;&nbsp;# odbc_errormsg -- Get the last error message<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;# Wir lassen Zeilen die mit # markiert sind als Kommentar durchgehen.<br />&nbsp;&nbsp;&nbsp;&nbsp;# Alternative<br />&nbsp;&nbsp;&nbsp;&nbsp;#gelb($fromline.'»'.__LINE__,__FILE__, $sql, 'b' );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if( !</font><font color="#0000BB">$sql_ohne_kommentare </font><font color="#007700">= </font><font color="#0000BB">trim</font><font color="#007700">( </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/([^\n]*?)[#]+[^\n]*/s" </font><font color="#007700">, </font><font color="#DD0000">"</font><font color="#007700">$</font><font color="#DD0000">1" </font><font color="#007700">, </font><font color="#0000BB">$sql </font><font color="#007700">)) ) continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#blau($fromline.'»'.__LINE__,__FILE__, $sql_ohne_kommentare , 'b'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;#$sql = preg_replace( '/([\s]+)[\s^\n]*\#/si' , "\\1\n#" , $sql );<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= @</font><font color="#0000BB">odbc_exec</font><font color="#007700">( </font><font color="#0000BB">$hDB </font><font color="#007700">, </font><font color="#0000BB">$sql_ohne_kommentare </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># War es SELECT ??? oder WITH ???<br />&nbsp;&nbsp;&nbsp;&nbsp;#preg_match( "/\s*(\w+)\b/s", trim( $sql ) , $erg );<br />&nbsp;&nbsp;&nbsp;&nbsp;#$sql_erstes_wort = strtoupper($erg[1]);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if(</font><font color="#0000BB">$result</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$num_rows </font><font color="#007700">= </font><font color="#0000BB">odbc_num_rows</font><font color="#007700">( </font><font color="#0000BB">$result </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$num_fields </font><font color="#007700">= </font><font color="#0000BB">odbc_num_fields</font><font color="#007700">( </font><font color="#0000BB">$result </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else </font><font color="#0000BB">$num_rows </font><font color="#007700">= </font><font color="#0000BB">$num_fields </font><font color="#007700">= </font><font color="#DD0000">'Syntax-Fehler'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;form method="get"&gt;'</font><font color="#007700">; <br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">echo_form_content</font><font color="#007700">(</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">, </font><font color="#0000BB">$textarea_cols</font><font color="#007700">, </font><font color="#0000BB">$textarea_rows</font><font color="#007700">, </font><font color="#0000BB">$table_name</font><font color="#007700">, </font><font color="#0000BB">$sql </font><font color="#007700">, </font><font color="#0000BB">$num_rows</font><font color="#007700">, </font><font color="#0000BB">$num_fields </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( !</font><font color="#0000BB">$result </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"odbc_exec misslungen! (&lt;font size=-3&gt;$result&lt;/font&gt;)"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">rot</font><font color="#007700">(</font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#0000BB">$sql_ohne_kommentare </font><font color="#007700">. </font><font color="#DD0000">"\n" </font><font color="#007700">. </font><font color="#0000BB">odbc_errormsg</font><font color="#007700">() , </font><font color="#DD0000">'bj'&nbsp;&nbsp;</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># $fromline.'»'.$line,__FILE__<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#&nbsp;&nbsp;&nbsp;&nbsp;int odbc_fetch_into ( int result_id [, int rownumber, array result_array] ) - <br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;Liefert die Anzahl der Ergebnisspalten zurück, bei einem Fehler FALSE. <br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">weis</font><font color="#007700">(</font><font color="#DD0000">'&amp;nbsp;&amp;nbsp;&lt;b&gt;Anzahl&lt;/b&gt; der &lt;u&gt;veränderten&lt;/u&gt; bzw. &lt;u&gt;eingefügten&lt;/u&gt; / &lt;u&gt;gelöschten&lt;/u&gt; Tupel:&amp;nbsp;' </font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#DD0000">'&amp;nbsp;&amp;nbsp;&lt;b&gt;'</font><font color="#007700">.</font><font color="#0000BB">$num_rows </font><font color="#007700">.</font><font color="#DD0000">'&lt;/b&gt;'</font><font color="#007700">. <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"&amp;nbsp;&amp;nbsp;(&lt;font size=-2&gt;odbc_num_rows( $result )=&lt;b&gt;"</font><font color="#007700">.</font><font color="#0000BB">$num_rows</font><font color="#007700">.</font><font color="#DD0000">"&lt;/b&gt; odbc_num_fields( $result )=&lt;b&gt;"</font><font color="#007700">.</font><font color="#0000BB">$num_fields</font><font color="#007700">.</font><font color="#DD0000">"&lt;/b&gt;&lt;/font&gt;)" </font><font color="#007700">, </font><font color="#DD0000">'5'&nbsp;&nbsp;</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Man könnte versuchen, das Datenholen hier zu steuern, aber die Steuerung würde nicht, <br />&nbsp;&nbsp;&nbsp;&nbsp;# alle Fälle berücksichtigen.<br />&nbsp;&nbsp;&nbsp;&nbsp;# if( $sql_erstes_wort != 'SELECT' &amp;&amp; $sql_erstes_wort != 'WITH') exit;<br />&nbsp;&nbsp;&nbsp;&nbsp;###########################################<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;# Ausgabe- HTML - schnell und standard<br />&nbsp;&nbsp;&nbsp;&nbsp;# odbc_result_all --&nbsp;&nbsp;Gibt das aktuelle Abfrageergebnis als HTML-Tabelle aus <br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if( </font><font color="#0000BB">0 </font><font color="#007700">){ echo </font><font color="#0000BB">odbc_result_all</font><font color="#007700">( </font><font color="#0000BB">$result </font><font color="#007700">); exit; }<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// Liefert eine neue Zeile in einem Ergebnis einer Abfrage als Array zurueck<br />&nbsp;&nbsp;&nbsp;&nbsp;// Als Schluessel kann dabei sowohl die Feldnummer als auch der Feldname<br />&nbsp;&nbsp;&nbsp;&nbsp;// verwendet werden<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$echo_table_first_row_flag </font><font color="#007700">= </font><font color="#0000BB">true</font><font color="#007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Schutz vor Endlosschleifen, 200 Datensätze genügen völlig.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$max_schleifen_loops </font><font color="#007700">= </font><font color="#0000BB">50</font><font color="#007700">; </font><font color="#0000BB">$schleifen_loops </font><font color="#007700">= </font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;while( </font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">odbc_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">) ){ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$schleifen_loops</font><font color="#007700">++ &gt; </font><font color="#0000BB">$max_schleifen_loops </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">rot</font><font color="#007700">(</font><font color="#DD0000">'&lt;b&gt;&lt;u&gt;Notaus:&lt;/u&gt;&lt;/b&gt; ' </font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#DD0000">'Die &lt;b&gt;maximal zulässige Menge von '</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$max_schleifen_loops</font><font color="#007700">.</font><font color="#DD0000">' anzuzeigenden Datensätzen&lt;/b&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(wie im Script gesetzt) wurde überschritten und daher die Ausgabe unterbrochen.' </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Ausgabe- HTML - schnell und schlampig<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if( </font><font color="#0000BB">0 </font><font color="#007700">){ echo </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"\n"</font><font color="#007700">,</font><font color="#DD0000">"&lt;br&gt;\n" </font><font color="#007700">, </font><font color="#0000BB">var_export</font><font color="#007700">( </font><font color="#0000BB">$row </font><font color="#007700">, </font><font color="#0000BB">true </font><font color="#007700">) );<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Ausgabe- HTML - hübscher<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if( </font><font color="#0000BB">1 </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset( </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">odbc_affected_rows</font><font color="#007700">] ); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">###############<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Es is hübscher, wenn wir odbc_affected_rows nur einmal ausgeben und nicht jedesmal, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# der Wert is eh immer gleich. Wir nehmen in daher raus.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Die Spalte odbc_affected_rows wurde künstlich hinzugefügt, entweder vom PHP- Interpreter oder<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# von DB2 oder sonstwo... jedenfalls wollen wir die nicht in der Tabelle sehen.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Einmal reicht.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###############<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Wir brauchen hier schon die neuen Keys, für die Spaltenbeschriftungen.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if( </font><font color="#0000BB">$echo_table_first_row_flag </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$echo_table_first_row_flag </font><font color="#007700">= </font><font color="#0000BB">false</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#$odbc_affected_rows = $row[odbc_affected_rows];&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$table_keys </font><font color="#007700">= </font><font color="#0000BB">array_keys</font><font color="#007700">( </font><font color="#0000BB">$row </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Bestimmung der Spalte id, wir gehen einfach dafon aus die erste Spalte sei die jenige.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ist ausreichend für unsere Sache.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$tbl_id_name </font><font color="#007700">= </font><font color="#0000BB">$table_keys</font><font color="#007700">[</font><font color="#0000BB">0</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># wir geben einen ausführlichen select, bei dem möglichst viel implizit vorgegeben ist, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# also vorlage aus.<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp </font><font color="#007700">= array();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach( </font><font color="#0000BB">$table_keys </font><font color="#007700">AS </font><font color="#0000BB">$key </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$key </font><font color="#007700">= </font><font color="#0000BB">strtolower</font><font color="#007700">( </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"/.*\./"</font><font color="#007700">,</font><font color="#DD0000">""</font><font color="#007700">, </font><font color="#0000BB">$key </font><font color="#007700">) );<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#$name = $table_name.'.'.$key ;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$name2 </font><font color="#007700">= </font><font color="#0000BB">$table_name</font><font color="#007700">[</font><font color="#0000BB">0</font><font color="#007700">].</font><font color="#DD0000">'.'</font><font color="#007700">.</font><font color="#0000BB">$key</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp</font><font color="#007700">[] = </font><font color="#0000BB">$name2</font><font color="#007700">.</font><font color="#DD0000">' AS "'</font><font color="#007700">.</font><font color="#0000BB">$name2</font><font color="#007700">.</font><font color="#DD0000">'"'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;font size="-3" color="#a0a0a0"&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s </font><font color="#007700">= </font><font color="#DD0000">'SELECT '</font><font color="#007700">. </font><font color="#0000BB">implode</font><font color="#007700">(</font><font color="#DD0000">', '</font><font color="#007700">,</font><font color="#0000BB">$temp</font><font color="#007700">).</font><font color="#DD0000">' FROM '</font><font color="#007700">. </font><font color="#0000BB">$table_name</font><font color="#007700">.</font><font color="#DD0000">' AS '</font><font color="#007700">.</font><font color="#0000BB">$table_name</font><font color="#007700">[</font><font color="#0000BB">0</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#0000BB">$s</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">' &lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">.</font><font color="#DD0000">'?sql='</font><font color="#007700">. </font><font color="#0000BB">urlencode</font><font color="#007700">(</font><font color="#0000BB">$s</font><font color="#007700">) .</font><font color="#DD0000">'&amp;table_name='</font><font color="#007700">.</font><font color="#0000BB">$table_name</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'" accesskey="3"&gt;(ALT+3)&lt;/a&gt;&lt;/font&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;table border="1" cellpadding="1" cellspacing="0" align="center"&gt;&lt;tr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;tr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#for( $i = 0; $i &lt; count( $table_keys ) ; $i++){&nbsp;&nbsp;&nbsp;&nbsp;$key = $table_keys[$i];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#rot('ANFANG ' ,'', $key );<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$table_keys</font><font color="#007700">[] = </font><font color="#DD0000">'#Vorlagen'</font><font color="#007700">; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach( </font><font color="#0000BB">$table_keys </font><font color="#007700">AS </font><font color="#0000BB">$key </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$key </font><font color="#007700">=== </font><font color="#DD0000">'#Vorlagen' </font><font color="#007700">) { echo </font><font color="#DD0000">"&lt;td align='center'&gt;&lt;em&gt;&lt;b&gt;$table_name ...&lt;/b&gt;&lt;/em&gt;&lt;/td&gt;"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb('MITTE ' ,'', $key );<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#0000BB">get_table_title</font><font color="#007700">( </font><font color="#0000BB">$key</font><font color="#007700">, </font><font color="#0000BB">$sql</font><font color="#007700">, </font><font color="#0000BB">$tbl </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;/tr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo '&lt;td&gt;'.implode( '&lt;/td&gt;&lt;td&gt;&lt;a href="'.$PHP_SELF.'?sql='. $s .'&amp;table_name='.$tbl.'"&gt;' , $table_keys ).'&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;';<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Exemplarisch reicht eine update und eine delete zeile... später lassen wir die weg... zwecks weniger overhead.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'#Vorlagen'</font><font color="#007700">] = </font><font color="#DD0000">'&lt;font size="-2"&gt;'</font><font color="#007700">.</font><font color="#0000BB">get_update_sql_who_does_nothing</font><font color="#007700">( </font><font color="#0000BB">$table_name</font><font color="#007700">, </font><font color="#0000BB">$row </font><font color="#007700">, </font><font color="#0000BB">$tbl_id_name </font><font color="#007700">).</font><font color="#DD0000">'&lt;/font&gt;' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'#Vorlagen'</font><font color="#007700">] .= </font><font color="#DD0000">'&lt;br&gt;&lt;font size="-2"&gt;DELETE FROM '</font><font color="#007700">.</font><font color="#0000BB">$table_name</font><font color="#007700">.</font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#DD0000">' WHERE '</font><font color="#007700">.</font><font color="#0000BB">$tbl_id_name</font><font color="#007700">.</font><font color="#DD0000">' = '</font><font color="#007700">.</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">$tbl_id_name</font><font color="#007700">].</font><font color="#DD0000">'&lt;/font&gt;' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb('Sql-Befehl war:' ,'', "\$table_name=$table_name"&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;tr&gt;&lt;td&gt;'</font><font color="#007700">.</font><font color="#0000BB">implode</font><font color="#007700">( </font><font color="#DD0000">'&lt;/td&gt;&lt;td&gt;' </font><font color="#007700">, </font><font color="#0000BB">array_values</font><font color="#007700">( </font><font color="#0000BB">$row </font><font color="#007700">) ).</font><font color="#DD0000">'&lt;/td&gt;&lt;/tr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;/table&gt;&lt;/form&gt;&lt;br&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Speicher freigeben<br />&nbsp;&nbsp;&nbsp;&nbsp;# Es kann tatsächlich eine Rolle spielen, den Speicher vor der nächsten Anfrage frei zu geben,<br />&nbsp;&nbsp;&nbsp;&nbsp;# wenn bei der nächsten Anfrage etwas aus der letzten Änderung verwendet werden soll.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if(</font><font color="#0000BB">$result</font><font color="#007700">)</font><font color="#0000BB">odbc_free_result</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />}<br /><br /></font><font color="#FF8000"># Verbindung schliessen<br /></font><font color="#007700">if(</font><font color="#0000BB">$hDB</font><font color="#007700">)</font><font color="#0000BB">odbc_close</font><font color="#007700">(</font><font color="#0000BB">$hDB</font><font color="#007700">);<br /><br /></font><font color="#FF8000">###############<br /># Funktionen und classen aller hier ungen, aufrufe weiter oben<br />###############<br /><br />#############################################<br /># Funktionen die was mit Datenbank zu tun haben.<br />#############################################<br /><br /></font><font color="#007700">function </font><font color="#0000BB">myodbc_fetch_array</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$arr </font><font color="#007700">= Array();<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$num_cols </font><font color="#007700">= </font><font color="#0000BB">odbc_num_fields</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># odbc_num_fields -- Liefert die Anzahl der Ergebnisspalten<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$count </font><font color="#007700">= </font><font color="#0000BB">odbc_fetch_into</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">, </font><font color="#0000BB">$arr</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># odbc_fetch_into -- Liefert die Anzahl der Ergebnisspalten zurück, bei einem Fehler FALSE.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if (</font><font color="#0000BB">$count </font><font color="#007700">&gt; </font><font color="#0000BB">0</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (</font><font color="#0000BB">$i </font><font color="#007700">= </font><font color="#0000BB">1</font><font color="#007700">; </font><font color="#0000BB">$i </font><font color="#007700">&lt;= </font><font color="#0000BB">$num_cols</font><font color="#007700">; </font><font color="#0000BB">$i</font><font color="#007700">++) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$arr</font><font color="#007700">[</font><font color="#0000BB">odbc_field_name</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">, </font><font color="#0000BB">$i</font><font color="#007700">)] = </font><font color="#0000BB">$arr</font><font color="#007700">[</font><font color="#0000BB">$i </font><font color="#007700">- </font><font color="#0000BB">1</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># odbc_field_name() gibt den Namen der Spalte mit der Nummer field_number für des Abfrageergebnisses result_id zurück. <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;else return </font><font color="#0000BB">false</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#0000BB">$arr</font><font color="#007700">;<br />}<br />function </font><font color="#0000BB">odbc_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if ( @</font><font color="#0000BB">odbc_fetch_row</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$line</font><font color="#007700">=array(</font><font color="#DD0000">"odbc_affected_rows"</font><font color="#007700">=&gt;</font><font color="#0000BB">odbc_num_rows</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</font><font color="#0000BB">$f</font><font color="#007700">=</font><font color="#0000BB">1</font><font color="#007700">;</font><font color="#0000BB">$f</font><font color="#007700">&lt;=</font><font color="#0000BB">odbc_num_fields</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">);</font><font color="#0000BB">$f</font><font color="#007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$fn</font><font color="#007700">=</font><font color="#0000BB">odbc_field_name</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">,</font><font color="#0000BB">$f</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$fct</font><font color="#007700">=</font><font color="#0000BB">odbc_result</font><font color="#007700">(</font><font color="#0000BB">$rs</font><font color="#007700">,</font><font color="#0000BB">$fn</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$newline</font><font color="#007700">=array(</font><font color="#0000BB">$fn </font><font color="#007700">=&gt; </font><font color="#0000BB">$fct</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$line</font><font color="#007700">=</font><font color="#0000BB">array_merge</font><font color="#007700">(</font><font color="#0000BB">$line</font><font color="#007700">,</font><font color="#0000BB">$newline</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//echo $f.": ".$fn."=".$fct."&lt;br&gt;";<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#0000BB">$line</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#0000BB">false</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br />function </font><font color="#0000BB">exit_in</font><font color="#007700">( </font><font color="#0000BB">$line </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">$text </font><font color="#007700">. </font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#DD0000">'&lt;b&gt;Script wird beendet.&lt;/b&gt; &lt;br&gt;'</font><font color="#007700">. </font><font color="#0000BB">odbc_errormsg</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;global </font><font color="#0000BB">$php_as_shell_flag</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$php_as_shell_flag </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">.= </font><font color="#DD0000">'Bitte RETRUN-/ENTER-Taste klicken.'</font><font color="#007700">; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">fgets</font><font color="#007700">(</font><font color="#0000BB">STDIN</font><font color="#007700">,</font><font color="#0000BB">100</font><font color="#007700">); exit;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">rot</font><font color="#007700">(</font><font color="#0000BB">$fromline</font><font color="#007700">.</font><font color="#DD0000">'»'</font><font color="#007700">.</font><font color="#0000BB">$line</font><font color="#007700">,</font><font color="#0000BB">__FILE__</font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#DD0000">'b'&nbsp;&nbsp;</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /></font><font color="#FF8000">#####################################<br /># Ausgabe - Funktionen<br /># (lasse alles in einer Datei dann wird beim kopieren nix vergessen.)<br />#####################################<br /></font><font color="#007700">function </font><font color="#0000BB">get_table_title</font><font color="#007700">( </font><font color="#0000BB">$key</font><font color="#007700">, </font><font color="#0000BB">$sql</font><font color="#007700">, </font><font color="#0000BB">$tbl </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">preg_match</font><font color="#007700">(</font><font color="#DD0000">"/[A-Z]+[a-z]+/" </font><font color="#007700">, </font><font color="#0000BB">$key </font><font color="#007700">) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Es kommen wahrscheinlich groß und klein Buchstaben, vor und wohl absichtlich zur<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# besseren Lesbarkeit.... was wir erhalten möchten:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$key_pretty </font><font color="#007700">= </font><font color="#DD0000">'"'</font><font color="#007700">.</font><font color="#0000BB">$key</font><font color="#007700">.</font><font color="#DD0000">'"'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb('$key:' ,'', 1 );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Entgegen der DB2 - Konvention, gleich der MySql - Konvention, mag ich <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# kleingeschriebenen Eigen-Namen<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$key_pretty </font><font color="#007700">= </font><font color="#0000BB">strtolower</font><font color="#007700">( </font><font color="#0000BB">$key </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb('$key:' ,'', 2 );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#blau('ENDE ' ,'', $key );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s </font><font color="#007700">= </font><font color="#0000BB">urlencode</font><font color="#007700">( </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/\bORDER\s+BY\b.*/" </font><font color="#007700">, </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$sql </font><font color="#007700">) )&nbsp;&nbsp;;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s_asc </font><font color="#007700">= </font><font color="#0000BB">$s </font><font color="#007700">. </font><font color="#0000BB">urlencode</font><font color="#007700">( </font><font color="#DD0000">' ORDER BY '</font><font color="#007700">.</font><font color="#0000BB">$key_pretty</font><font color="#007700">. </font><font color="#DD0000">' ASC '</font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s_desc </font><font color="#007700">= </font><font color="#0000BB">$s </font><font color="#007700">. </font><font color="#0000BB">urlencode</font><font color="#007700">( </font><font color="#DD0000">' ORDER BY '</font><font color="#007700">.</font><font color="#0000BB">$key_pretty</font><font color="#007700">. </font><font color="#DD0000">' DESC '</font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$k </font><font color="#007700">= </font><font color="#DD0000">'&lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">.</font><font color="#DD0000">'?sql='</font><font color="#007700">. </font><font color="#0000BB">urlencode</font><font color="#007700">( </font><font color="#0000BB">$sql </font><font color="#007700">) .</font><font color="#DD0000">'&amp;key_search='</font><font color="#007700">. </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"/.*\W/"</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#0000BB">$key</font><font color="#007700">).</font><font color="#DD0000">'"&gt;'</font><font color="#007700">.</font><font color="#0000BB">$key</font><font color="#007700">.</font><font color="#DD0000">'&lt;/a&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$a </font><font color="#007700">= </font><font color="#DD0000">'&lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">.</font><font color="#DD0000">'?sql='</font><font color="#007700">. </font><font color="#0000BB">$s_asc </font><font color="#007700">.</font><font color="#DD0000">'&amp;table_name='</font><font color="#007700">.</font><font color="#0000BB">$tbl</font><font color="#007700">.</font><font color="#DD0000">'"&gt;A&lt;/a&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$d </font><font color="#007700">= </font><font color="#DD0000">'&lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">.</font><font color="#DD0000">'?sql='</font><font color="#007700">. </font><font color="#0000BB">$s_desc </font><font color="#007700">.</font><font color="#DD0000">'&amp;table_name='</font><font color="#007700">.</font><font color="#0000BB">$tbl</font><font color="#007700">.</font><font color="#DD0000">'"&gt;D&lt;/a&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#DD0000">"&lt;td&gt;$k $a $d&lt;/td&gt;"</font><font color="#007700">;<br />}<br />function </font><font color="#0000BB">pretty_sql</font><font color="#007700">( &amp;</font><font color="#0000BB">$sql</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb($fromline.'»'.$line,__FILE__, $sql , 'b'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;# Ich mag es nicht wenn, Namen groß geschrieben sind... bin hier also ganz <br />&nbsp;&nbsp;&nbsp;&nbsp;# gegen die Konvention von DB2 ... Aber, ich darf nicht alles klein machen,<br />&nbsp;&nbsp;&nbsp;&nbsp;# weil sonst im Zusammenspiel mit "MeinName" Fehler auftreten könnten :(<br />&nbsp;&nbsp;&nbsp;&nbsp;# $sql = strtolower( $sql) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$list_newline </font><font color="#007700">= </font><font color="#DD0000">'select|insert|delete|update|from|where|order|values|union|fetch|group|having|union|intersect|case|when|else|with|drop|in'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Ganz kleine SQLs brauchen wir nicht auftrennen.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if( </font><font color="#0000BB">strlen</font><font color="#007700">( </font><font color="#0000BB">$sql </font><font color="#007700">) &gt; </font><font color="#0000BB">60 </font><font color="#007700">) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#0000BB">trim</font><font color="#007700">(</font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">'/([^#])\s+\b('</font><font color="#007700">.</font><font color="#0000BB">$list_newline</font><font color="#007700">.</font><font color="#DD0000">')(\b)/is' </font><font color="#007700">, </font><font color="#0000BB">strtoupper</font><font color="#007700">(</font><font color="#DD0000">"\\1 \n\\2\\3"</font><font color="#007700">) , </font><font color="#0000BB">$sql </font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Kommentare sollen in in einer extra Zeile stehen.<br />&nbsp;&nbsp;&nbsp;&nbsp;#rot($fromline.'»'.$line,__FILE__, $sql , 'b'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/([^\n#]+)([#]+)/s" </font><font color="#007700">, </font><font color="#DD0000">"</font><font color="#007700">$</font><font color="#DD0000">1</font><font color="#007700">\n$</font><font color="#DD0000">2" </font><font color="#007700">, </font><font color="#0000BB">$sql </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#rot($fromline.'»'.$line,__FILE__, $sql , 'f'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$list_upper&nbsp;&nbsp;</font><font color="#007700">= </font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">$list_newline </font><font color="#007700">. </font><font color="#DD0000">'|into|soundex|as|with|max|min|SUBSTr|DISTINcT|AND|OR|all|rand'</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'|asc|desc|count|by|grouping|then|end|cast|DEcIMAL|avg|FULL|OUTER|JOIN|integer|locate|RTRIM|length|DIFFERENCE|not|exists|excep'</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$list_upper_array </font><font color="#007700">= </font><font color="#0000BB">explode</font><font color="#007700">(</font><font color="#DD0000">'|'</font><font color="#007700">, </font><font color="#0000BB">$list_upper </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach( </font><font color="#0000BB">$list_upper_array </font><font color="#007700">as </font><font color="#0000BB">$n </font><font color="#007700">) </font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">'/(\b)'</font><font color="#007700">.</font><font color="#0000BB">$n</font><font color="#007700">.</font><font color="#DD0000">'(\b)/is' </font><font color="#007700">, </font><font color="#DD0000">"\\1"</font><font color="#007700">.</font><font color="#0000BB">strtoupper</font><font color="#007700">(</font><font color="#0000BB">$n</font><font color="#007700">).</font><font color="#DD0000">"\\2" </font><font color="#007700">, </font><font color="#0000BB">$sql </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb($fromline.'»'.$line,__FILE__, $sql . "\n$list_newline" , 'b'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;######################################<br /></font><font color="#007700">}<br />function </font><font color="#0000BB">echo_form_content</font><font color="#007700">(</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">, </font><font color="#0000BB">$textarea_cols</font><font color="#007700">, </font><font color="#0000BB">$textarea_rows</font><font color="#007700">, </font><font color="#0000BB">$table_name</font><font color="#007700">=</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#0000BB">$sql</font><font color="#007700">=</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#0000BB">$num_rows</font><font color="#007700">=</font><font color="#0000BB">0</font><font color="#007700">, </font><font color="#0000BB">$num_fields</font><font color="#007700">=</font><font color="#0000BB">0 </font><font color="#007700">){<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;table align="center" border="2" cellpadding="2" cellspacing="0" bordercolor="#ffff00"&gt;&lt;tr&gt;&lt;td&gt;'</font><font color="#007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#blau($fromline.'»'.__LINE__,__FILE__, $sql, 'p' );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$textarea_cols </font><font color="#007700">= </font><font color="#0000BB">100</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb('Sql-Befehl war:' ,'', '&lt;code&gt;'.$sql.'&lt;/code&gt;' , 'p'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$info_text </font><font color="#007700">= </font><font color="#DD0000">'; # focus hier ALT+2'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$einrueckung </font><font color="#007700">= </font><font color="#0000BB">str_repeat</font><font color="#007700">(</font><font color="#DD0000">' '</font><font color="#007700">, </font><font color="#0000BB">$textarea_cols </font><font color="#007700">- </font><font color="#0000BB">strlen</font><font color="#007700">(</font><font color="#0000BB">$info_text</font><font color="#007700">) - </font><font color="#0000BB">3 </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$info_text1 </font><font color="#007700">=&nbsp;&nbsp;</font><font color="#0000BB">$einrueckung</font><font color="#007700">.</font><font color="#0000BB">$info_text</font><font color="#007700">; <br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$info_text2 </font><font color="#007700">= </font><font color="#DD0000">"\n# Die Standard SELECTS * oben, erhällt man auch über"</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"\n# ALT+(Erster Buchstabe der Tabelle.)+ENTER "</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$info_text2 </font><font color="#007700">.= </font><font color="#DD0000">"</font><font color="#007700">\n</font><font color="#DD0000"># odbc_num_rows: $num_rows ,&nbsp;&nbsp;odbc_num_fields: $num_fields"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$info_text </font><font color="#007700">= </font><font color="#0000BB">$info_text1</font><font color="#007700">.</font><font color="#0000BB">$info_text2</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( !</font><font color="#0000BB">eregi</font><font color="#007700">( </font><font color="#0000BB">quotemeta</font><font color="#007700">(</font><font color="#0000BB">$info_text1</font><font color="#007700">), </font><font color="#0000BB">$sql </font><font color="#007700">)) </font><font color="#0000BB">$sql </font><font color="#007700">.= </font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#0000BB">$info_text</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$textarea_rows </font><font color="#007700">= </font><font color="#0000BB">substr_count </font><font color="#007700">( </font><font color="#0000BB">$sql </font><font color="#007700">, </font><font color="#DD0000">"\n" </font><font color="#007700">) + </font><font color="#0000BB">1 </font><font color="#007700">- </font><font color="#0000BB">substr_count </font><font color="#007700">( </font><font color="#0000BB">$info_text </font><font color="#007700">, </font><font color="#DD0000">"\n" </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># onmouseover="load_backup();"<br />&nbsp;&nbsp;&nbsp;&nbsp;# onmouseover="load_backup();"<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;em&gt;&amp;nbsp;&amp;nbsp;SQL-Befehl fuer DB2&lt;/em&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;input type="Submit" accesskey="1" value="SQL senden (ALT+1)"'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">' onmouseover="load_backup();" '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">' onclick="load_backup();" " '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$PHP_SELF</font><font color="#007700">.</font><font color="#DD0000">'?sql='</font><font color="#007700">. </font><font color="#DD0000">'SELECT * FROM ' </font><font color="#007700">. </font><font color="#0000BB">$table_name </font><font color="#007700">.</font><font color="#DD0000">'&amp;table_name='</font><font color="#007700">.</font><font color="#0000BB">$table_name</font><font color="#007700">.</font><font color="#DD0000">'"&gt;SELECT * FROM '</font><font color="#007700">.</font><font color="#0000BB">$table_name</font><font color="#007700">.</font><font color="#DD0000">'&lt;/a&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&lt;textarea name="sql" cols="'</font><font color="#007700">.</font><font color="#0000BB">$textarea_cols</font><font color="#007700">.</font><font color="#DD0000">'" rows="'</font><font color="#007700">.</font><font color="#0000BB">$textarea_rows</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'" '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">' onclick="load_backup();" " '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo ' onmouseout="set_backup();" ';<br />&nbsp;&nbsp;&nbsp;&nbsp;#echo ' onblur="set_backup();" ';<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">' onmouseover="load_backup();" '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">' onchange="set_backup();" '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo ' onkeypress="set_backup();" ';<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">' onfocus="this.select();" " '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">' accesskey="2"&gt;'</font><font color="#007700">.</font><font color="#0000BB">$sql</font><font color="#007700">.</font><font color="#DD0000">'&lt;/textarea&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#blau($fromline.'»'.__LINE__,__FILE__, $sql, 'p' );<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;/td&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># show_text_in_form(t){&nbsp;&nbsp;&nbsp;&nbsp;document.forms[0].elements['sql'].value = t; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# load_backup(){ document.forms[0].elements['sql'].value = backup_text; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# set_backup(){&nbsp;&nbsp;&nbsp;&nbsp;backup_text = document.forms[0].elements['sql'].value; }<br />&nbsp;&nbsp;&nbsp;&nbsp;#gelb('Sql-Befehl war:' ,'', '&lt;code&gt;'.$sql.'&lt;/code&gt;' , 'b'&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;/tr&gt;&lt;/table&gt;'</font><font color="#007700">;<br />}<br />function </font><font color="#0000BB">echo_aufgabe</font><font color="#007700">( </font><font color="#0000BB">$aufgabennr </font><font color="#007700">, </font><font color="#0000BB">$nummerierung </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$sql_befehl </font><font color="#007700">, </font><font color="#0000BB">$tbl_name&nbsp;&nbsp;</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;global </font><font color="#0000BB">$PHP_SELF</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql_befehl </font><font color="#007700">= </font><font color="#0000BB">trim</font><font color="#007700">(</font><font color="#0000BB">$sql_befehl</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"/&lt;[^&gt;]*&gt;/"</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#0000BB">trim</font><font color="#007700">( </font><font color="#0000BB">$nummerierung </font><font color="#007700">) );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"/\s+/s"</font><font color="#007700">, </font><font color="#DD0000">' '</font><font color="#007700">, </font><font color="#0000BB">$sql_befehl </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#$status = str_replace('"','´´',"window.status='".str_replace(array("\n","'"),array(' ',"\'"),$s)."';");<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$status </font><font color="#007700">= </font><font color="#DD0000">"'"</font><font color="#007700">.</font><font color="#0000BB">str_replace</font><font color="#007700">(array(</font><font color="#DD0000">"\n"</font><font color="#007700">,</font><font color="#DD0000">"'"</font><font color="#007700">,</font><font color="#DD0000">'"'</font><font color="#007700">),array(</font><font color="#DD0000">' '</font><font color="#007700">,</font><font color="#DD0000">"\'"</font><font color="#007700">,</font><font color="#DD0000">'´´'</font><font color="#007700">),</font><font color="#0000BB">$s</font><font color="#007700">).</font><font color="#DD0000">"'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$js_alert </font><font color="#007700">= </font><font color="#0000BB">js_alert</font><font color="#007700">(</font><font color="#0000BB">$fromline</font><font color="#007700">.</font><font color="#DD0000">'»'</font><font color="#007700">.</font><font color="#0000BB">$line</font><font color="#007700">,</font><font color="#0000BB">__FILE__</font><font color="#007700">, </font><font color="#0000BB">$text</font><font color="#007700">, </font><font color="#DD0000">'br' </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># return true;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$js_text </font><font color="#007700">= </font><font color="#DD0000">"'"</font><font color="#007700">. </font><font color="#0000BB">substr</font><font color="#007700">( </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/.*?\.php\s*\\\(.*)\);/is"</font><font color="#007700">, </font><font color="#DD0000">"</font><font color="#007700">$</font><font color="#DD0000">1" </font><font color="#007700">, </font><font color="#0000BB">$js_alert</font><font color="#007700">[</font><font color="#0000BB">1</font><font color="#007700">] ) , </font><font color="#0000BB">1</font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#&nbsp;&nbsp;&nbsp;"alert( '$zeile $file_kurz".'\\n'."$text');",<br />&nbsp;&nbsp;&nbsp;&nbsp;#gelb($fromline.'»'.$line,__FILE__, quotemeta(str_replace('.','\.',__FILE__)) .'&lt;hr&gt;' . $js_text&nbsp;&nbsp;);<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;# show_text_in_form(t){&nbsp;&nbsp;&nbsp;&nbsp;document.forms[0].elements['sql'].value = t; }<br />&nbsp;&nbsp;&nbsp;&nbsp;# load_backup(){ document.forms[0].elements['sql'].value = backup_text; }<br />&nbsp;&nbsp;&nbsp;&nbsp;# set_backup(){&nbsp;&nbsp;&nbsp;&nbsp;backup_text = document.forms[0].elements['sql'].value; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$onmouseover </font><font color="#007700">= </font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#DD0000">' onmouseover="show_text_in_form('</font><font color="#007700">.</font><font color="#0000BB">$js_text</font><font color="#007700">.</font><font color="#DD0000">','</font><font color="#007700">.</font><font color="#0000BB">$status</font><font color="#007700">.</font><font color="#DD0000">');"'</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#DD0000">' '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb($fromline.'»'.$line,__FILE__, $onmouseover , 'b' );<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">echo </font><font color="#DD0000">'&lt;font size="+1"&gt; &lt;b&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">substr</font><font color="#007700">( </font><font color="#0000BB">$nummerierung </font><font color="#007700">, </font><font color="#0000BB">0 </font><font color="#007700">, </font><font color="#0000BB">4 </font><font color="#007700">)) == </font><font color="#DD0000">'&lt;br&gt;' </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$nummerierung </font><font color="#007700">=&nbsp;&nbsp;</font><font color="#0000BB">substr</font><font color="#007700">( </font><font color="#0000BB">$nummerierung </font><font color="#007700">, </font><font color="#0000BB">4&nbsp;&nbsp;</font><font color="#007700">);&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;br&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&amp;#664&lt;/b&gt; '</font><font color="#007700">.(</font><font color="#0000BB">is_numeric</font><font color="#007700">(</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">0</font><font color="#007700">])?</font><font color="#DD0000">'&lt;em&gt;Aufg.&lt;/em&gt;'</font><font color="#007700">:</font><font color="#DD0000">''</font><font color="#007700">).</font><font color="#0000BB">$nummerierung</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">' &lt;a href="' </font><font color="#007700">. </font><font color="#0000BB">$PHP_SELF </font><font color="#007700">. </font><font color="#DD0000">'?aufgabennr='</font><font color="#007700">. </font><font color="#0000BB">$aufgabennr<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">.</font><font color="#DD0000">'"'</font><font color="#007700">.</font><font color="#0000BB">$onmouseover</font><font color="#007700">.</font><font color="#DD0000">'&gt;'</font><font color="#007700">.</font><font color="#0000BB">substr</font><font color="#007700">( </font><font color="#0000BB">$sql_befehl </font><font color="#007700">, </font><font color="#0000BB">0 </font><font color="#007700">, </font><font color="#0000BB">3 </font><font color="#007700">).</font><font color="#DD0000">'...&lt;/a&gt; '</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#DD0000">'&lt;a href="javascript:show_text_in_form('</font><font color="#007700">.</font><font color="#0000BB">$status</font><font color="#007700">.</font><font color="#DD0000">','</font><font color="#007700">.</font><font color="#0000BB">$status</font><font color="#007700">.</font><font color="#DD0000">');alert('</font><font color="#007700">.</font><font color="#0000BB">$js_text<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">.</font><font color="#DD0000">');"'</font><font color="#007700">.</font><font color="#0000BB">$onmouseover</font><font color="#007700">.</font><font color="#DD0000">"\n"</font><font color="#007700">.</font><font color="#DD0000">' onkeypress="'</font><font color="#007700">.</font><font color="#0000BB">$status</font><font color="#007700">.</font><font color="#DD0000">'"&gt;Text&lt;/a&gt;&lt;/font&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#gelb($fromline.'»'.$line,__FILE__, "\$temp=$temp, \$temp[0]=".$temp[0].(is_numeric($temp[0])?'&lt;em&gt;Aufg.&lt;/em&gt;':'')&nbsp;&nbsp;);<br /></font><font color="#007700">}<br />function </font><font color="#0000BB">get_update_sql_who_does_nothing</font><font color="#007700">( &amp;</font><font color="#0000BB">$table_name</font><font color="#007700">, &amp;</font><font color="#0000BB">$row</font><font color="#007700">, &amp;</font><font color="#0000BB">$tbl_id_name </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$update </font><font color="#007700">= </font><font color="#DD0000">'UPDATE ' </font><font color="#007700">. </font><font color="#0000BB">$table_name </font><font color="#007700">. </font><font color="#DD0000">" SET "</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;while( list( </font><font color="#0000BB">$k</font><font color="#007700">, </font><font color="#0000BB">$v </font><font color="#007700">) = </font><font color="#0000BB">each</font><font color="#007700">( </font><font color="#0000BB">$row </font><font color="#007700">) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># odbc_field_type -- Liefert den Datentyp eines Feldes<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if(!</font><font color="#0000BB">$v</font><font color="#007700">) continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$v </font><font color="#007700">= ( !</font><font color="#0000BB">is_numeric</font><font color="#007700">( </font><font color="#0000BB">$v </font><font color="#007700">) &amp;&amp; !</font><font color="#0000BB">ereg</font><font color="#007700">(</font><font color="#DD0000">','</font><font color="#007700">,</font><font color="#0000BB">$v</font><font color="#007700">) ) ? </font><font color="#DD0000">"'$v'" </font><font color="#007700">: </font><font color="#0000BB">str_replace</font><font color="#007700">( </font><font color="#DD0000">',' </font><font color="#007700">, </font><font color="#DD0000">'.' </font><font color="#007700">, </font><font color="#0000BB">$v </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp</font><font color="#007700">[] = </font><font color="#DD0000">"</font><font color="#007700">\n</font><font color="#DD0000"> $k = $v "</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$update </font><font color="#007700">.= @</font><font color="#0000BB">implode</font><font color="#007700">( </font><font color="#DD0000">', ' </font><font color="#007700">, </font><font color="#0000BB">$temp </font><font color="#007700">) . </font><font color="#DD0000">"</font><font color="#007700">\n</font><font color="#DD0000"> WHERE $tbl_id_name = " </font><font color="#007700">. </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">$tbl_id_name</font><font color="#007700">] . </font><font color="#DD0000">" "</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#0000BB">$update </font><font color="#007700">. </font><font color="#DD0000">'&lt;a href="?sql=' </font><font color="#007700">. </font><font color="#0000BB">urlencode</font><font color="#007700">(</font><font color="#0000BB">$update</font><font color="#007700">) . </font><font color="#DD0000">'" accesskey="4"&gt;(ALT+4)&lt;/a&gt;'</font><font color="#007700">;<br />}<br />function </font><font color="#0000BB">horizontal_line</font><font color="#007700">( </font><font color="#0000BB">$newline1</font><font color="#007700">, </font><font color="#0000BB">$width </font><font color="#007700">, </font><font color="#0000BB">$newline2 </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#0000BB">str_repeat</font><font color="#007700">( </font><font color="#DD0000">"\n" </font><font color="#007700">, </font><font color="#0000BB">$newline1 </font><font color="#007700">) . </font><font color="#0000BB">str_repeat</font><font color="#007700">( </font><font color="#DD0000">"_" </font><font color="#007700">, </font><font color="#0000BB">$width </font><font color="#007700">) . </font><font color="#0000BB">str_repeat</font><font color="#007700">( </font><font color="#DD0000">"\n" </font><font color="#007700">, </font><font color="#0000BB">$newline2 </font><font color="#007700">) ; <br />}<br />function </font><font color="#0000BB">weis</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'ffffff'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">blau</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'66CCFF'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">rot</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'FFCC99'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">BIG_gelb</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'FFFFCC'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">gelb</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'FFFFCC'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">green</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'32CD32'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">pink</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#0000BB">false</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">=</font><font color="#0000BB">false </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">$c</font><font color="#007700">)</font><font color="#0000BB">$c</font><font color="#007700">=</font><font color="#DD0000">'FFB6C1'</font><font color="#007700">;</font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$c</font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">);<br />}<br />function </font><font color="#0000BB">farbtabelle</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">, </font><font color="#0000BB">$file </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">, </font><font color="#0000BB">$farbe </font><font color="#007700">, </font><font color="#0000BB">$wort_bgcolor_ar</font><font color="#007700">, </font><font color="#0000BB">$width </font><font color="#007700">= </font><font color="#DD0000">'100%' </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># n - Zeilennummerierung<br />&nbsp;&nbsp;&nbsp;# e - htmlentities<br />&nbsp;&nbsp;&nbsp;# p - pre<br />&nbsp;&nbsp;&nbsp;# f - textarea<br />&nbsp;&nbsp;&nbsp;# j - jump<br />&nbsp;&nbsp;&nbsp;# v - var_export<br />&nbsp;&nbsp;&nbsp;# x - exit<br />&nbsp;&nbsp;&nbsp;#echo "&lt;h2&gt;$code=\$code&lt;/h2&gt;" ;<br />&nbsp;&nbsp;&nbsp;</font><font color="#007700">global </font><font color="#0000BB">$SERVER_NAME</font><font color="#007700">;<br /><br />&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$SERVER_NAME </font><font color="#007700">!= </font><font color="#DD0000">'localhost' </font><font color="#007700">)unset(</font><font color="#0000BB">$file</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$file_kurz </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"-.*[\\\\/]-is"</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#0000BB">$file </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$is_php </font><font color="#007700">= ( </font><font color="#0000BB">strpos</font><font color="#007700">( </font><font color="#0000BB">$text </font><font color="#007700">, </font><font color="#DD0000">'?'</font><font color="#007700">.</font><font color="#DD0000">'&gt;'&nbsp;&nbsp;</font><font color="#007700">)) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">is_array</font><font color="#007700">( </font><font color="#0000BB">$text </font><font color="#007700">) || </font><font color="#0000BB">is_object</font><font color="#007700">( </font><font color="#0000BB">$text </font><font color="#007700">) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">var_export</font><font color="#007700">( </font><font color="#0000BB">$text</font><font color="#007700">, </font><font color="#0000BB">true </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$is_php </font><font color="#007700">= </font><font color="#0000BB">true</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'n'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Die Zeilen werden durchnummeriert.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$code </font><font color="#007700">.= </font><font color="#DD0000">'p' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp </font><font color="#007700">= </font><font color="#0000BB">explode</font><font color="#007700">(</font><font color="#DD0000">"\n"</font><font color="#007700">, </font><font color="#0000BB">$text</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$count </font><font color="#007700">= </font><font color="#0000BB">count</font><font color="#007700">(</font><font color="#0000BB">$temp</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$l </font><font color="#007700">= </font><font color="#0000BB">strlen</font><font color="#007700">( </font><font color="#0000BB">$count </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( </font><font color="#0000BB">$i </font><font color="#007700">= </font><font color="#0000BB">0 </font><font color="#007700">; </font><font color="#0000BB">$i </font><font color="#007700">&lt; </font><font color="#0000BB">$count </font><font color="#007700">; </font><font color="#0000BB">$i</font><font color="#007700">++ ) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$ii</font><font color="#007700">= </font><font color="#0000BB">$i</font><font color="#007700">+</font><font color="#0000BB">1 </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while( </font><font color="#0000BB">strlen</font><font color="#007700">( </font><font color="#0000BB">$ii </font><font color="#007700">) &lt; </font><font color="#0000BB">$l </font><font color="#007700">){ </font><font color="#0000BB">$ii </font><font color="#007700">= </font><font color="#DD0000">'0' </font><font color="#007700">. </font><font color="#0000BB">$ii</font><font color="#007700">; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">$i</font><font color="#007700">])</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">$i</font><font color="#007700">] = </font><font color="#0000BB">$ii</font><font color="#007700">.</font><font color="#DD0000">":"</font><font color="#007700">.</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">$i</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">implode </font><font color="#007700">(</font><font color="#DD0000">"\n" </font><font color="#007700">, </font><font color="#0000BB">$temp </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'b'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">( array(</font><font color="#DD0000">'&nbsp;&nbsp;'</font><font color="#007700">,</font><font color="#DD0000">"\n"</font><font color="#007700">) , array(</font><font color="#DD0000">'&amp;nbsp; '</font><font color="#007700">,</font><font color="#DD0000">"&lt;br&gt;\n"</font><font color="#007700">) , </font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'p'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$pre1 </font><font color="#007700">= </font><font color="#DD0000">'&lt;pre&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$pre2 </font><font color="#007700">= </font><font color="#DD0000">'&lt;/pre&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># beschreibt die dicke des Tabellenrandes<br />&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$tbl_border </font><font color="#007700">= (&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">preg_match</font><font color="#007700">(</font><font color="#DD0000">"/\d+/"</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">,</font><font color="#0000BB">$digit</font><font color="#007700">)&nbsp;&nbsp;&nbsp;) ? </font><font color="#0000BB">$digit</font><font color="#007700">[</font><font color="#0000BB">0</font><font color="#007700">] : </font><font color="#0000BB">1 </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'f'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$pre1 </font><font color="#007700">= </font><font color="#DD0000">'&lt;textarea cols="50" rows="5"&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$pre2 </font><font color="#007700">= </font><font color="#DD0000">'&lt;/textarea&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;}elseif( </font><font color="#0000BB">$is_php </font><font color="#007700">) </font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">( array(</font><font color="#DD0000">'&amp;lt;?'</font><font color="#007700">,</font><font color="#DD0000">'?&amp;gt;'</font><font color="#007700">) , </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">highlight_string</font><font color="#007700">( </font><font color="#DD0000">'&lt;?'</font><font color="#007700">.</font><font color="#0000BB">$text</font><font color="#007700">.</font><font color="#DD0000">'?&gt;' </font><font color="#007700">, </font><font color="#0000BB">true </font><font color="#007700">) ) ;<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'e'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">htmlentities</font><font color="#007700">(</font><font color="#0000BB">$text</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">is_array</font><font color="#007700">( </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># die schlüssel sind gleichzeitig die Strings die mit der Hintergrundfarbe der zugehörigen Werte ersetzt werden.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">while( list( </font><font color="#0000BB">$string </font><font color="#007700">, </font><font color="#0000BB">$bgcolor </font><font color="#007700">) = </font><font color="#0000BB">each</font><font color="#007700">( </font><font color="#0000BB">$wort_bgcolor_ar </font><font color="#007700">) ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">( </font><font color="#0000BB">$string </font><font color="#007700">, </font><font color="#DD0000">'&lt;span style="border: 1px solid #BEBEBE; background-color:'</font><font color="#007700">.</font><font color="#0000BB">$bgcolor</font><font color="#007700">.</font><font color="#DD0000">'"&gt;'</font><font color="#007700">.</font><font color="#0000BB">$string</font><font color="#007700">.</font><font color="#DD0000">'&lt;/span&gt;' </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo "$code , $farbe";<br />&nbsp;&nbsp;&nbsp;</font><font color="#007700">if ( </font><font color="#0000BB">is_int</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">)) </font><font color="#0000BB">$zeile </font><font color="#007700">= </font><font color="#DD0000">'Zeile = ' </font><font color="#007700">. </font><font color="#0000BB">$zeile </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$strlen_status </font><font color="#007700">= </font><font color="#0000BB">strlen </font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">. </font><font color="#0000BB">$file_kurz </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$strlen_text</font><font color="#007700">= </font><font color="#0000BB">strlen </font><font color="#007700">( </font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$status_zeile </font><font color="#007700">= </font><font color="#DD0000">'&lt;td valign="top" bgcolor="#FFFFFF" nowrap&gt;&lt;font color="Black"&gt;&lt;font size="-1"&gt;'</font><font color="#007700">.</font><font color="#0000BB">$zeile</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;br&gt;&lt;font size="-2"&gt;&lt;a href="'</font><font color="#007700">.</font><font color="#0000BB">$file</font><font color="#007700">.</font><font color="#DD0000">'" target="o"&gt;'</font><font color="#007700">.</font><font color="#0000BB">$file_kurz</font><font color="#007700">.</font><font color="#DD0000">'&lt;/a&gt;&lt;/font&gt;&lt;/font&gt;&lt;/td&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text_zeile </font><font color="#007700">= </font><font color="#DD0000">'&lt;td bgcolor="#'</font><font color="#007700">.</font><font color="#0000BB">$farbe</font><font color="#007700">.</font><font color="#DD0000">'" width="'</font><font color="#007700">.</font><font color="#0000BB">$width</font><font color="#007700">.</font><font color="#DD0000">'"&gt;&lt;font color="Black"&gt;'</font><font color="#007700">.</font><font color="#0000BB">$pre1</font><font color="#007700">.</font><font color="#0000BB">$text</font><font color="#007700">.</font><font color="#0000BB">$pre2</font><font color="#007700">.</font><font color="#DD0000">'&lt;/font&gt;&lt;/td&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;table border="'</font><font color="#007700">.</font><font color="#0000BB">$tbl_border</font><font color="#007700">.</font><font color="#DD0000">'" cellspacing="0" cellpadding="0" width="'</font><font color="#007700">.</font><font color="#0000BB">$width</font><font color="#007700">.</font><font color="#DD0000">'"&gt;&lt;tr&gt;'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000BB">$strlen_status </font><font color="#007700">* </font><font color="#0000BB">12 </font><font color="#007700">&gt; </font><font color="#0000BB">$strlen_text </font><font color="#007700">) echo </font><font color="#0000BB">$status_zeile </font><font color="#007700">. </font><font color="#0000BB">$text_zeile </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;else echo </font><font color="#0000BB">$status_zeile </font><font color="#007700">. </font><font color="#DD0000">'&lt;/tr&gt;&lt;tr&gt;' </font><font color="#007700">. </font><font color="#0000BB">$text_zeile </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;/tr&gt;&lt;/table&gt;' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'x'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"&lt;b&gt; - E &lt;u&gt;X&lt;/u&gt; I T - &lt;/b&gt;"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'j'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># es soll gleich zu dieser meldung gesprungen werden.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#echo '&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;';<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$name </font><font color="#007700">= </font><font color="#DD0000">'f'</font><font color="#007700">.</font><font color="#0000BB">mktime</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">'&lt;form name="'</font><font color="#007700">.</font><font color="#0000BB">$name</font><font color="#007700">.</font><font color="#DD0000">'"&gt;'</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;input type="Button" style="font-size: 9px; color: black; border: 0px White; background: White;" name="'</font><font color="#007700">.</font><font color="#0000BB">$name</font><font color="#007700">.</font><font color="#DD0000">'" value="Jump"&gt;&lt;/form&gt;'&nbsp;&nbsp;</font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;script language="JavaScript"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.forms["'</font><font color="#007700">.</font><font color="#0000BB">$name</font><font color="#007700">.</font><font color="#DD0000">'"].elements["'</font><font color="#007700">.</font><font color="#0000BB">$name</font><font color="#007700">.</font><font color="#DD0000">'"].focus();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#echo '&lt;/td&gt;';<br />&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#007700">}<br />}<br />function </font><font color="#0000BB">js_alert</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">= </font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#0000BB">$file </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">,&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#DD0000">'' </font><font color="#007700">, </font><font color="#0000BB">$code </font><font color="#007700">= </font><font color="#DD0000">'h' </font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">( </font><font color="#DD0000">"'" </font><font color="#007700">, </font><font color="#DD0000">"\'" </font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'h'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># HTML- Tags werden drin gelassen.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp </font><font color="#007700">= </font><font color="#DD0000">'/([^\\\\])&lt;[^&lt;&gt;]*?&gt;/si' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"\n"</font><font color="#007700">,</font><font color="#DD0000">'\\n'</font><font color="#007700">,</font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#0000BB">$temp </font><font color="#007700">,</font><font color="#DD0000">"</font><font color="#007700">$</font><font color="#DD0000">1"</font><font color="#007700">, </font><font color="#0000BB">$text </font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/&lt;br&gt;/is" </font><font color="#007700">, </font><font color="#DD0000">'\\n' </font><font color="#007700">,&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/&lt;\/?(b|p|hr)&gt;/is" </font><font color="#007700">, </font><font color="#DD0000">'' </font><font color="#007700">,&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$file_kurz </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"-.*[\\\\/]-is"</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#0000BB">$file </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'n'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># Die Zeilen werden durchnummeriert.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$code </font><font color="#007700">.= </font><font color="#DD0000">'p' </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$temp </font><font color="#007700">= </font><font color="#0000BB">explode</font><font color="#007700">(</font><font color="#DD0000">"\n"</font><font color="#007700">, </font><font color="#0000BB">$text</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$count </font><font color="#007700">= </font><font color="#0000BB">count</font><font color="#007700">(</font><font color="#0000BB">$temp</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$l </font><font color="#007700">= </font><font color="#0000BB">strlen</font><font color="#007700">( </font><font color="#0000BB">$count </font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( </font><font color="#0000BB">$i </font><font color="#007700">= </font><font color="#0000BB">0 </font><font color="#007700">; </font><font color="#0000BB">$i </font><font color="#007700">&lt; </font><font color="#0000BB">$count </font><font color="#007700">; </font><font color="#0000BB">$i</font><font color="#007700">++ ) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$ii</font><font color="#007700">= </font><font color="#0000BB">$i</font><font color="#007700">+</font><font color="#0000BB">1 </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while( </font><font color="#0000BB">strlen</font><font color="#007700">( </font><font color="#0000BB">$ii </font><font color="#007700">) &lt; </font><font color="#0000BB">$l </font><font color="#007700">){ </font><font color="#0000BB">$ii </font><font color="#007700">= </font><font color="#DD0000">'0' </font><font color="#007700">. </font><font color="#0000BB">$ii</font><font color="#007700">; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">$i</font><font color="#007700">])</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">$i</font><font color="#007700">] = </font><font color="#0000BB">$ii</font><font color="#007700">.</font><font color="#DD0000">":"</font><font color="#007700">.</font><font color="#0000BB">$temp</font><font color="#007700">[</font><font color="#0000BB">$i</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">implode </font><font color="#007700">(</font><font color="#DD0000">"\n" </font><font color="#007700">, </font><font color="#0000BB">$temp </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'p'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/[\r\f\n\t]/" </font><font color="#007700">, </font><font color="#DD0000">'\\n'&nbsp;&nbsp;</font><font color="#007700">,&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">( </font><font color="#DD0000">"/[\r\f\n\t]/" </font><font color="#007700">, </font><font color="#DD0000">' ' </font><font color="#007700">,&nbsp;&nbsp;</font><font color="#0000BB">$text </font><font color="#007700">) ;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'e'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">#$text = htmlentities($text);<br />&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />&nbsp;&nbsp;&nbsp;if ( </font><font color="#0000BB">is_int</font><font color="#007700">( </font><font color="#0000BB">$zeile </font><font color="#007700">)) </font><font color="#0000BB">$zeile </font><font color="#007700">= </font><font color="#DD0000">'Zeile = ' </font><font color="#007700">. </font><font color="#0000BB">$zeile </font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">eregi</font><font color="#007700">(</font><font color="#DD0000">'r'</font><font color="#007700">,</font><font color="#0000BB">$code</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000"># r steht für return<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">return array( </font><font color="#DD0000">"&lt;script language='JavaScript'&gt;"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"alert( '$zeile $file_kurz"</font><font color="#007700">.</font><font color="#DD0000">'\\n'</font><font color="#007700">.</font><font color="#DD0000">"$text');"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"&lt;/script&gt;"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else<br />&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"&lt;script language='JavaScript'&gt;<br />&nbsp;&nbsp;&nbsp;alert( '$zeile $file_kurz"</font><font color="#007700">.</font><font color="#DD0000">'\\n'</font><font color="#007700">.</font><font color="#DD0000">"$text');<br />&nbsp;&nbsp;&nbsp;&lt;/script&gt;"</font><font color="#007700">;<br />}<br /></font><font color="#FF8000">######################################<br />### Es folgen nur noch Kommentare. ###<br />######################################<br />#################################################<br /># Diverse Notizen/Aufschriebe<br /># (mache oben einen Verweis, dass es diese unten gibt)<br />#################################################<br />/*<br />odbc_error -- Get the last error code<br /><br />google: "odbc_connect"<br />http://www.google.de/search?hl=de&amp;client=firefox-a&amp;rls=org.mozilla%3Ade-DE%3Aofficial&amp;q=odbc_connect&amp;btnG=Suche&amp;meta=lr%3Dlang_de<br /><br />http://www.google.de/search?hl=de&amp;client=firefox-a&amp;rls=org.mozilla%3Ade-DE%3Aofficial&amp;q=odbc_connect+db2&amp;btnG=Suche&amp;meta=lr%3Dlang_de<br />odbc_connect db2<br /><br />ODBC Datenbankquellen 2000<br />http://www.google.de/search?hl=de&amp;client=firefox-a&amp;rls=org.mozilla%3Ade-DE%3Aofficial&amp;q=ODBC+Datenbankquellen+2000&amp;btnG=Suche&amp;meta=<br /><br />odbc installieren<br />http://www.google.de/search?hl=de&amp;client=firefox-a&amp;rls=org.mozilla%3Ade-DE%3Aofficial&amp;q=odbc+installieren&amp;btnG=Suche&amp;meta=lr%3Dlang_de<br />Systemsteuerung &gt; Verwaltung &gt; Datenquellen<br /><br />datenquelle: datenquelle<br />CLI-Parameter: DBALIAS<br />Wert: TEST<br />Anstehender Wert: TEST<br /><br />Im Dos-Fenster kopieren: Markieren und dann Eingabetaste<br /><br />Warning: odbc_connect(): SQL error: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified, SQL state IM002 in SQLConnect in E:\test.php on line 37<br />Verbindungsaufbau misslungen..<br /><br />odbc_connect db2 Data source name not found and no default driver specified<br />http://www.google.de/search?hl=de&amp;client=firefox-a&amp;rls=org.mozilla:de-DE:official&amp;lr=lang_de&amp;q=odbc_connect+db2+Data+source+name+not+found+and+no+default+driver+specified&amp;spell=1<br /><br />Warning: odbc_connect(): SQL error: [IBM][CLI Driver] SQL30082N&nbsp;&nbsp;Die Verbindung<br />konnte auf Grund der Sicherheitsbedingung "24" ("USERNAME AND/OR PASSWORD INVALI<br />D") nicht hergestellt werden.&nbsp;&nbsp;SQLSTATE=08001<br />, SQL state 08001 in SQLConnect in E:\test.php on line 49<br />Verbindungsaufbau misslungen..<br />C:\Dokumente und Einstellungen\sasaus42&gt;<br /><br />to-do:<br />------<br />- DB2 Personal Edition, PHP installieren<br />- DB2 Datenbank erzeugen.<br />- Systemsteuerung &gt; Verwaltung &gt; Datenquellen (ODBC)<br /> dort unter USER DSN Hinzufügen "IBM DB2 DBC DRIVER"<br />&nbsp;&nbsp;&nbsp;&nbsp;und <br /> dort unter SYSTEM DSN Hinzufügen "IBM DB2 DBC DRIVER"<br />*/<br /></font><font color="#0000BB">?&gt;<br /></font>&lt;/body&gt;&lt;/html&gt;</font>
</code></li>
<li>
  <table>
    <tr>
      <td rowspan="2">
	  <a name='aufgabenliste.inc.php'></a><input value="aufgabenliste.inc.php" onClick='this.select()'  onChange='on_change()' style="font: 150%;" size=21 name="aufgabenliste.inc.php">
	</td>
      <td><a href="#aufgabe4.4.5_v0503082041.php" accesskey="l"><u><b>l</b></u>ast</a></td>
      <td rowspan="2">
	  &nbsp;&nbsp;<a href='aufgabenliste.inc.php' target='_blank'>Script ausführen</a>
	  &nbsp;&nbsp;&nbsp;Zum Anfang mit <strong>Pos1-Taste</strong>
	  &nbsp;&nbsp;&nbsp;Zum Ende mit <strong>Ende-Taste</strong>
	  &nbsp;&nbsp;&nbsp;Seitenweise nach oben/unten mit <strong>Bild-Tasten</strong>
	  </td>
    </tr>
    <tr>
      <td><a href="#" accesskey="n"><u><b>n</b></u>ext</a></td>
    </tr>
  </table>
	<hr>Verwendete <strong>PHP-Funktinen</strong>: <a href='http://de.php.net/manual/de/function.echo.php' target='nachlese'>echo</a>, <a href='http://de.php.net/manual/de/function.rand.php' target='nachlese'>rand</a><br>Verwendete <strong>MySQL-Funktinen</strong>: <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=SELECT+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>SELECT</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=FROM+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>FROM</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=INSERT+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>INSERT</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=WHERE+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>WHERE</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=TRIM+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>TRIM</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=varchar+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>varchar</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=SOUNDEX+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>SOUNDEX</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=OUTER JOIN+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>OUTER JOIN</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=LEFT OUTER JOIN+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>LEFT OUTER JOIN</a>, <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=COUNT+%2Fdoc%2Fmysql%2Fde%2F+site%3Adev.mysql.com&meta=lr%3Dlang_de' target='nachlese'>COUNT</a><br>Verwendete <strong>HTML-Tags</strong>: <a href='http://www.google.de/search?hl=de&ie=UTF-8&q=%3Cbr%3E+.org%2Fhtml%2F+site%3Ade.selfhtml.org&meta=lr%3Dlang_de' target='nachlese'>&lt;br&gt;</a><br><br><code><font color="#000000">
<font color="#0000BB">&lt;?&nbsp;&nbsp;&nbsp;&nbsp;<br />$aufgaben_list </font><font color="#007700">= array();<br /></font><font color="#FF8000">###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[</font><font color="#0000BB">1</font><font color="#007700">] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt; </font><font color="#DD0000">'&lt;b&gt;&lt;u&gt;2.3.3.1&lt;/u&gt;&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt; </font><font color="#DD0000">'Geben Sie alle Städte an, die ungefähr 100.000 Einwohner haben.<br />Sortieren Sie die Städte <br />nach der Abweichung von dieser Einwohnerzahl <br />(Städte mit kleinerer Abweichung stehen weiter vorne in der Liste).<br /><br />Geben Sie alle Städte an, die um maximal 10.000 Einwohner von 100.000 Einwohnern abweichen.' </font><font color="#007700">, <br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br />SELECT name, einwohner, ABS( einwohner - 100000 ) AS abweichung&nbsp;&nbsp;FROM STADT <br />WHERE einwohner + 10000 &gt;= 100000 <br />AND&nbsp;&nbsp;&nbsp;&nbsp;einwohner - 10000 &lt;= 100000 <br />ORDER BY ABS( einwohner - 100000 ) ' </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'STADT' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />##echo '&lt;br&gt;';<br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt; </font><font color="#DD0000">'&lt;b&gt;&lt;u&gt;2.3.3.2&lt;/u&gt; Ähnlichkeit mittels LOCATE|SOUNDEX|DIFFERENCE&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt; <br /></font><font color="#DD0000">'Geben Sie alle Länder an, deren Hauptstadtname Ähnlichkeit mit dem Landesnamen hat.<br />Die Lösung ganz am Ende mit DIFFERENCE gefällt mir am besten.<br />' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br />SELECT s.name AS Stadt, l.name AS Land&nbsp;&nbsp;, length( RTRIM(s.name) ) AS Stadtlänge , length( RTRIM(l.name) ) AS Landlänge<br />FROM land l, stadt s<br /><br />### LOCATE( s1, s2 ) -&gt; Integer<br />### gibt die Position des ersten Auftauchens von String s2 in String s1 an.<br />WHERE l.hauptstadt&nbsp;&nbsp;= s.s_id<br />AND ( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCATE(RTRIM(s.name), RTRIM( l.name)) &gt; 0 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;LOCATE(RTRIM(l.name), RTRIM( s.name)) &gt; 0&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;;<br /><br />### Zur Verdeutlichung einmal nur das enthaltensein von Stadtnamen im Landesnamen<br />SELECT s.name AS Stadt, l.name AS Land&nbsp;&nbsp;, length( RTRIM(s.name) ) AS Stadtlänge , length( RTRIM(l.name) ) AS Landlänge<br />FROM land l, stadt s <br />WHERE l.hauptstadt = s.s_id AND LOCATE(RTRIM(s.name), RTRIM( l.name)) &gt; 0 ;<br /><br />### Und noch einmal umgekehrt, das enthaltensein von Landesnamen im Stadtnamen<br />SELECT s.name AS Stadt, l.name AS Land&nbsp;&nbsp;, length( RTRIM(s.name) ) AS Stadtlänge , length( RTRIM(l.name) ) AS Landlänge<br />FROM land l, stadt s <br />WHERE l.hauptstadt = s.s_id AND LOCATE( RTRIM( l.name) , RTRIM(s.name) ) &gt; 0 ;<br /><br />### Alternative Lösung mit Funktion SOUNDEX()<br />SELECT s.name AS Stadt, l.name AS Land<br />FROM land l, stadt s<br />WHERE l.hauptstadt = s.s_id AND SOUNDEX(s.name) = SOUNDEX(l.name);<br /><br />### Alternative Lösung mit Funktion DIFFERENCE( s1, s2 ) Klangübereinstimmung zw. 0 und 4<br />SELECT s.name AS Stadt, l.name AS Land, DIFFERENCE( s.name , l.name ) as Klangübereinstimmung<br />FROM land l, stadt s<br />WHERE l.hauptstadt = s.s_id AND DIFFERENCE( s.name , l.name ) &gt; 2<br />ORDER BY Klangübereinstimmung DESC<br />;<br /><br />'<br /> </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'STADT' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />#echo '&lt;br&gt;';<br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'INSERT .. MAX(S_ID)' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt; </font><font color="#DD0000">'Insert in eine Tabelle.' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">"<br />INSERT INTO stadt ( s_id, name, einwohner ) <br />VALUES ( <br />&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;SELECT MAX(S_ID)+1 FROM stadt&nbsp;&nbsp;), <br />&nbsp;&nbsp;&nbsp;&nbsp;'TestStadt', <br />&nbsp;&nbsp;&nbsp;&nbsp;12345 <br />);<br /><br />SELECT * FROM stadt WHERE S_ID &gt; 629;<br /><br />DELETE FROM STADT WHERE S_ID &gt; 629<br />"<br /></font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'STADT' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />#echo '&lt;br&gt;';<br /></font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">= </font><font color="#DD0000">"<br />SELECT s_id, concat(name , 'von stadtview') , einwohner &nbsp;&nbsp;&nbsp;&nbsp;FROM stadtview <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE name LIKE '%TestStadt%'<br />UNION <br />SELECT s_id, concat(name , 'von stadt'), einwohner &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM stadt <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE name LIKE '%TestStadt%'<br />ORDER BY s_id<br />"</font><font color="#007700">;<br /><br /></font><font color="#FF8000">###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;b&gt;&lt;u&gt;2.3.3.3 a), b), c), d), e), f)&lt;/u&gt;&lt;/b&gt; &amp;nbsp;VIEW' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Erzeugen Sie mit einer Sicht einen Auschnitt der Relation Stadt, <br />in der alle Städte mit mehr als fünf Millionen Einwohnern eingetragen sind. <br />Übernehmen Sie in die Sicht die Attribute S ID, Name und Einwohner. <br /><br />Weitere Teilaufgaben zwischen dem SQL- Befehl formuliert.<br />Beschreiben Sie für die folgenden Operationen jeweils die Reaktionen des Datenbanksystems:<br />' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br />CREATE VIEW stadtview ( s_id, name, einwohner) AS<br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT s_id, name, einwohner <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM stadt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE einwohner &gt; 10000000;<br /># Die Sicht ist erzeugt, jetzt wollen doch mal sehen was so drin steckt.<br />SELECT * FROM stadtview;<br /># 2.3.3.3 a) Stadt in Sicht mit mehr als fünf Millionen Einwohnern einfügen und ausgeben.<br />INSERT INTO stadtview (s_id, name, einwohner) <br />VALUES ( <br />&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;SELECT MAX(S_ID)+99&nbsp;&nbsp;FROM stadtview), <br />&nbsp;&nbsp;&nbsp;&nbsp;\'TestStadt\', <br />&nbsp;&nbsp;&nbsp;&nbsp;10000001 <br />);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;'</font><font color="#007700">. </font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">.</font><font color="#DD0000">"<br /># Interessant ist, das der eben eingefügte Datensatz zweimal angezeigt wird.<br /># Man sieht (vielleicht überraschend) dass der Datensatz in Tabelle stadt eingefügt wurde.<br /># obwohl der insert_ eindeutig in die view einfügt. ;<br /># 2.3.3.3 b)<br />DELETE FROM stadtview WHERE name = 'TestStadt' <br /># Wir werden gleich sehen, das sich dieses löschen <br /># wieder auf die Tabelle ausgwirkte. Im View ist der Eintrag auch nicht mehr zu finden. ;<br />"</font><font color="#007700">.&nbsp;&nbsp;</font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">.</font><font color="#DD0000">" ;<br /><br /># 2.3.3.3 c) <br /># Fügen Sie eine Stadt mit weniger als fünf Millionen Einwohnern in die Sicht ein.<br /># Lassen Sie sich die Sicht und die Relation Stadt ausgeben.<br />INSERT INTO stadtview (s_id, name, einwohner) <br />VALUES ( <br />&nbsp;&nbsp;&nbsp;&nbsp;( SELECT MAX(S_ID)+99 FROM stadtview ), <br />&nbsp;&nbsp;&nbsp;&nbsp;'TestStadt', <br />&nbsp;&nbsp;&nbsp;&nbsp;11 <br />)<br /># Wir werden sehen, dieser neue Datensatz erstens wieder in Tabelle stadt<br /># eingefügt wurde und zweitens in stadtview nicht mehr auftaucht, ganz gemäß<br /># der Bedinungen des VIEWS bezüglich der Einwohnerzahl. Fein :)<br /># Also alles so wie es sein sollte. Der VIEW bleibt stimmig.<br />;<br />"</font><font color="#007700">.&nbsp;&nbsp;</font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">.</font><font color="#DD0000">" <br />;<br /># 2.3.3.3 d) <br /># Fügen Sie die Stadt erneut mit mehr als fünf Millionen Einwohnern in die Sicht ein.<br /># Lassen Sie sich die Sicht ausgeben.<br />INSERT INTO stadtview (s_id, name, einwohner) <br />VALUES ( <br />&nbsp;&nbsp;&nbsp;&nbsp;( SELECT MAX(S_ID)+99 FROM stadtview ), <br />&nbsp;&nbsp;&nbsp;&nbsp;'TestStadt', <br />&nbsp;&nbsp;&nbsp;&nbsp;10000002 <br />)<br /># Interessant hier gibt es eine Fehlermeldung, weil dieser Index für den letzten Einfug in stadt<br /># verwendet wurde, also belegt ist.<br /># Dies wird nicht erkannt bzw. berücksichtig, da letzer Einfug nicht im VIEW vermerkt ist. ;<br />SELECT MAX(v.S_ID)+99 AS \"MAX(v.S_ID)+99\", MAX(v.S_ID) AS \"MAX(v.S_ID)\", <br />&nbsp;&nbsp;&nbsp;&nbsp;MAX(s.S_ID)+99 AS \"MAX(s.S_ID)+99\", MAX(s.S_ID) AS \"MAX(s.S_ID)\" <br />FROM stadtview AS v, stadt AS s&nbsp;&nbsp;&nbsp;&nbsp;;<br /><br />INSERT INTO stadtview (s_id, name, einwohner) <br />VALUES ( <br />&nbsp;&nbsp;&nbsp;&nbsp;( SELECT MAX(S_ID)+1 FROM stadt ), <br />&nbsp;&nbsp;&nbsp;&nbsp;'TestStadt', <br />&nbsp;&nbsp;&nbsp;&nbsp;10000002 <br />)<br />;<br />"</font><font color="#007700">.&nbsp;&nbsp;</font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">.</font><font color="#DD0000">" <br />;<br /># 2.3.3.3 e) <br /># Löschen Sie die Stadt aus der Sicht.<br />DELETE FROM stadtview WHERE einwohner = 10000002<br />;<br />"</font><font color="#007700">.&nbsp;&nbsp;</font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">.</font><font color="#DD0000">" ;<br /># 2.3.3.3 f) <br /># Löschen Sie die Stadt aus der Relation Stadt.<br />DELETE FROM stadt WHERE einwohner = 10000002<br /># Klar, wir wissen ja, das hat auswirkungen auf VIEWs und RELATION<br />;<br />"</font><font color="#007700">.&nbsp;&nbsp;</font><font color="#0000BB">$wo_ist_die_teststadt </font><font color="#007700">.</font><font color="#DD0000">" <br />;<br /># Und wieder löschen, für den nächsten Versuch :)<br />DROP VIEW stadtview;<br />DELETE FROM STADT WHERE S_ID &gt; 629;<br />"<br /> </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'stadtview' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />#echo '&lt;br&gt;';<br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;b&gt;&lt;u&gt;2.3.4.1&lt;/u&gt;&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Bestimmung sämtliche Nachbar-IDs von Bundesrepublik_Deutschland.<br />Tip: Eine Sicht anzulegen, um nur eine Anfrage zu stellen, ist etwas umständlich. <br />Dafür gibt es die WITH-Anweisung.' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">"<br />SELECT l.NAME, b.L_ID1, b.L_ID2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM LAND l ,&nbsp;&nbsp;BENACHBART b <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l.NAME LIKE '%Deutschland%' <br />&nbsp;&nbsp;&nbsp;&nbsp;AND ( &nbsp;&nbsp;&nbsp;&nbsp;l.L_ID = b.L_ID2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;l.L_ID = b.L_ID1 )<br />"<br /></font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'STADT' </font><font color="#007700">);<br /><br /></font><font color="#FF8000"># Wie lässt sich der Nachbar einer Region finden ?<br /># Die Info steht in Tabell BENACHBART<br />###############################<br /><br /><br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'2.3.4.1 a) Bevölkerungsdichte' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Bestimmen Sie die Bevölkerungsdichte der Region, die die Länder Algerien,<br />Libyen und sämtliche Nachbarn dieser Länder umfaßt.<br />Tip: Eine Sicht anzulegen, um nur eine Anfrage zu stellen, ist etwas umständlich.<br />' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">"<br />SELECT * FROM land AS l1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;(name = 'Algerien'&nbsp;&nbsp;OR&nbsp;&nbsp;name = 'Libyen') ;<br /># Wir brauchen also die Länder Algerien, Libyen<br /># Bevölkerungsdichte müsste Einwohner pro Fläche sein, also:<br />SELECT name, einwohner/ flaeche AS \"Bevölkerungsdichte\" FROM land AS l1 WHERE<br />(name = 'Algerien' OR name = 'Libyen') ;<br /><br /># zusammen<br />SELECT avg(einwohner/ flaeche) AS \"Bevölkerungsdichte\" FROM land AS l1 WHERE<br />(name = 'Algerien' OR name = 'Libyen') ;<br /><br /># Ok soweit, jetzt sollten noch alle Nachbarn einbezogen werden.<br /># Da hilft die Tabelle benachbart( l_id1 ,&nbsp;&nbsp;&nbsp;&nbsp;l_id2 )<br /># Suchen wir erst mal alle Länder ids der Nachbarn.<br />SELECT l_id1, l_id2 FROM benachbart<br />WHERE&nbsp;&nbsp;l_id1 IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land AS l1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE name LIKE 'Algerien%' OR name LIKE 'Libyen%' )<br />&nbsp;&nbsp;&nbsp;&nbsp;OR l_id2 IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land AS l1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE name LIKE 'Algerien%' OR name LIKE 'Libyen%' )<br /># Man muss hier aufpassen das man statt IN nicht versehentlich = schreibt.<br /># Es gäbe hier zwar keinen Fehler aber auch keine Ergebnisse.<br />;<br />SELECT l_id1&nbsp;&nbsp;AS \"l_id1 Nachbarn\", l_id2<br />FROM benachbart <br />WHERE l_id2 IN ( <br />SELECT l_id <br />FROM land <br />WHERE (name LIKE 'Algerien%' OR name LIKE 'Libyen%') )<br /># So haben wir erst mal alle ids der Nachbarn in der Spalte l_id1 von 6 bzw. 84<br /># Aber es könnte vielleicht ja Nachbarn in der anderen Spalte auch gebeen.<br /># Schaun wir mal.<br />;<br />SELECT l_id1 , l_id2 AS \"l_id2 Nachbarn\" FROM benachbart <br />WHERE l_id1 IN ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id FROM land <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE (name LIKE 'Algerien%' OR name LIKE 'Libyen%') )<br /># alle ids der Nachbarn stehen in der Spalte l_id2 von 6 bzw. 84<br />;&nbsp;&nbsp;&nbsp;&nbsp;<br />SELECT * FROM land <br />WHERE <br />l_id IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id1 FROM benachbart <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l_id2 IN ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id FROM land WHERE name LIKE 'Algerien%' OR name LIKE 'Libyen%'<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />)<br />OR l_id IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id2 FROM benachbart <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l_id1 IN ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id FROM land WHERE name LIKE 'Algerien%' OR name LIKE 'Libyen%'<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />)<br />OR name LIKE 'Algerien%' OR name LIKE 'Libyen%'<br /><br /># Jetzt haben wir tatsächlich alle Nachbarländer, aber es sieh etas unschön aus, finde ich.<br /># Mit dem letzten beiden or kriegen wir unsere beiden Länder auch noch hinnein.<br /># Es sollte auch eleganter gehen.<br /># Schauen wir mal was redundant ist und ersetzten dies mit einer temporären Sicht.<br />;<br /># Folgender Ansatz, hätte gehen sollen, geht aber nicht :( Warum eigentlich?<br />WITH my_region (l_id) AS (<br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id FROM land WHERE name LIKE 'Algerien%' OR name LIKE 'Libyen%'<br />)<br />SELECT * FROM land <br />WHERE <br />l_id IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id1 FROM benachbart <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l_id2 IN ( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_region&nbsp;&nbsp;&nbsp;&nbsp;)<br />)<br />OR l_id IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id2 FROM benachbart <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l_id1 IN ( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_region&nbsp;&nbsp;&nbsp;&nbsp;)<br />)<br />OR name LIKE 'Algerien%' OR name LIKE 'Libyen%'<br /><br /># Dise Vereinfachung führt leider zu Fehler ... ich weiss auch nicht warum.<br />;<br /><br />WITH my_region (l_id) AS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l.l_id FROM land l, benachbart b, land l2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l.l_id = b.l_id2&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;b.l_id1 = l2.l_id <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND (l2.name = 'Algerien' OR l2.name = 'Libyen') <br />&nbsp;&nbsp;&nbsp;&nbsp;UNION <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l.l_id FROM land l, benachbart b, land l2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l.l_id = b.l_id1&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;b.l_id2 = l2.l_id <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND (l2.name = 'Algerien' OR l2.name = 'Libyen') <br />) <br />SELECT l.name AS name, l.einwohner AS einwohner, l.flaeche AS flaeche <br />&nbsp;&nbsp;&nbsp;&nbsp;FROM land l, my_region<br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l.l_id = my_region.l_id&nbsp;&nbsp;&nbsp;&nbsp;<br /><br /># Das hier klappt.<br />"<br /></font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'land l, my_region m' </font><font color="#007700">);<br /><br /></font><font color="#FF8000"># Wie lässt sich der Nachbar einer Region finden ?<br /># Die Info steht in Tabell BENACHBART<br />###############################<br /><br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'2.3.4.1 b) Bevölkerungsdichte ohne Wüsten' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'2.3.4.1 b) Vergleichen Sie das Ergebnis mit der Bevölkerungsdichte die man erhält, wenn<br />man die Wüsten als unbewohnbar berücksichtigt.<br />' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br /># Wüsten wo sind die?<br />SELECT w.w_id AS "w.w_id", w.name AS "w.name", w.flaeche AS "w.flaeche", w.wuestenart AS "w.wuestenart" <br />FROM wueste AS w <br /># Aber welche wüsten muss ich berücksichtigen ?<br />;<br /># Hat das was mit Tabelle geo_wueste zu tun ?<br />SELECT g.lt_id AS "g.lt_id", g.w_id AS "g.w_id" <br />FROM geo_wueste AS g<br />; <br /># Und wohl der Tabelle landesteil<br />SELECT l.lt_id AS "lt.lt_id", lt.name AS "lt.name", lt.l_id AS "lt.l_id", lt.einwohner AS "lt.einwohner", lt.lage AS "lt.lage", lt.hauptstadt AS "lt.hauptstadt" <br />FROM landesteil AS lt<br /># Hier sehen wir einen zusammenhang zwischen lt.lt_id und lt.l_id<br />;<br />SELECT l.l_id AS "l.l_id", l.name AS "l.name", l.einwohner AS "l.einwohner", l.zuwachs AS "l.zuwachs", l.flaeche AS "l.flaeche", l.bsp AS "l.bsp", l.staatsform AS "l.staatsform", l.regierungschef AS "l.regierungschef", l.hauptstadt AS "l.hauptstadt" <br />FROM land AS l<br /># Hier haben wir dann wieder unsere l.l_id<br />;<br /># Ich will erst mal ausgeben können wo eine Wüste liegt, in welchem Land bzw. in welchen Ländern.<br />SELECT w.w_id AS "w.w_id", g.lt_id AS "g.lt_id" , lt.lt_id AS "lt.lt_id", l.l_id AS "l.l_id", <br />&nbsp;&nbsp;&nbsp;&nbsp;w.name AS "w.name", w.flaeche AS "w.flaeche", w.wuestenart AS "w.wuestenart", l.name AS "l.name" <br />FROM geo_wueste AS g, wueste AS w, landesteil AS lt, land AS l <br />WHERE w.w_id = g.lt_id AND g.lt_id = lt.lt_id<br />AND lt.l_id = l.l_id<br />;<br /># Ich verstehe nicht warum es oben mehrere gleiche Ergebnisszeilen gibt, natürlich lassen sich die leicht entfernen:<br />SELECT DISTINCT w.w_id AS "w.w_id", g.lt_id AS "g.lt_id" , lt.lt_id AS "lt.lt_id", l.l_id AS "l.l_id", <br />&nbsp;&nbsp;&nbsp;&nbsp;w.name AS "w.name", w.flaeche AS "w.flaeche", w.wuestenart AS "w.wuestenart", l.name AS "l.name" <br />FROM geo_wueste AS g, wueste AS w, landesteil AS lt, land AS l <br />WHERE w.w_id = g.lt_id AND g.lt_id = lt.lt_id<br />AND lt.l_id = l.l_id<br /># Außerdem will ich diesen Zusammenhang für alle 30 Wüsten angezeigt haben, jetzt sind es aber plötzlich nur noch 2<br />;<br />SELECT DISTINCT w.w_id AS "w.w_id", g.lt_id AS "g.lt_id" , lt.lt_id AS "lt.lt_id", l.l_id AS "l.l_id", <br />&nbsp;&nbsp;&nbsp;&nbsp;w.name AS "w.name", w.flaeche AS "w.flaeche", w.wuestenart AS "w.wuestenart", l.name AS "l.name" <br />FROM geo_wueste AS g, wueste AS w, landesteil AS lt, land AS l <br />WHERE w.w_id = g.lt_id AND g.lt_id = lt.lt_id AND lt.l_id = l.l_id<br />GROUP BY ROLLUP(w.w_id, g.lt_id, lt.lt_id, l.l_id,w.name,w.flaeche,w.wuestenart,l.name)<br />ORDER BY w.w_id, g.lt_id, lt.lt_id, l.l_id,w.name,w.flaeche,w.wuestenart,l.name<br /># Ich glaube wir müssen da mit UNION arbeiten ... nee ... oder wie?<br />;<br />SELECT DISTINCT w.w_id AS "w.w_id", g.lt_id AS "g.lt_id" , lt.lt_id AS "lt.lt_id", l.l_id AS "l.l_id", <br />&nbsp;&nbsp;&nbsp;&nbsp;w.name AS "w.name", w.flaeche AS "w.flaeche", w.wuestenart AS "w.wuestenart", l.name AS "l.name" <br />FROM geo_wueste AS g, wueste AS w, landesteil AS lt, land AS l <br />WHERE w.w_id = g.lt_id <br /><br />'<br /></font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'wueste' </font><font color="#007700">);<br /><br /></font><font color="#FF8000">###############################<br /><br /><br /><br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;b&gt;&lt;u&gt;4.4.5&lt;/u&gt;&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Eine kleine Applikation<br />1. &nbsp;&nbsp;&nbsp;&nbsp;Implementieren Sie eine Webanfrageschnittstelle für DB2 (ähnlich der Schnittstelle<br />&nbsp;&nbsp;&nbsp;&nbsp;die für die Vorlesung DBS I eingesetzt wird).<br />2. &nbsp;&nbsp;&nbsp;&nbsp;Falls noch nicht geschehen, erweitern Sie die Schnittstelle so, da. auch Insert-,<br />&nbsp;&nbsp;&nbsp;&nbsp;Update- und Delete-Ausdrücke verarbeitet werden können. Geben Sie dabei als<br />&nbsp;&nbsp;&nbsp;&nbsp;Ausgabe die Anzahl der veränderten bzw. eingefügten/gelöschten Tupel an.' <br /></font><font color="#007700">, </font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'SELECT * FROM BERG'<br /></font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'STADT' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />#echo '&lt;br&gt;';<br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;br&gt;&lt;b&gt;&lt;u&gt;GROUP und DISTINCT&lt;/u&gt;&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Und einmal ohne DISTINCT SELECT ...' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">"<br />SELECT * FROM berg WHERE gebirge &lt; 'b' <br />ORDER BY gebirge ASC<br />;<br /># DISTINCT entfernt doppelt Werte<br />SELECT DISTINCT gebirge FROM berg WHERE gebirge &lt; 'b' <br />;<br /># Obwohl hier die Ausgabe gleich wie die oben ist, gruppiert GROUP, <br /># und ist damit nicht gleich DISTINCT' ,<br />SELECT gebirge FROM berg <br />GROUP BY gebirge<br />;<br />"</font><font color="#007700">.</font><font color="#DD0000">'<br />SELECT GEBIRGE , COUNT(name) AS "AnzahlBerge", MAX(HOEHE ) "Groester" ,MIN(HOEHE ) "Kleinster", <br />&nbsp;&nbsp;&nbsp;&nbsp;MAX(HOEHE )-MIN(HOEHE ) AS "Unterschied" <br />FROM BERG <br />&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY GEBIRGE <br />&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY COUNT(name) DESC<br />;<br /># Hier sieht man zusätzlich eine Zeile die alle Gruppen zusammengefasst, als eine Gruppe behandelt.<br />SELECT <br />GEBIRGE , COUNT(name) AS "AnzahlBerge", MAX(HOEHE ) "Groester" ,MIN(HOEHE ) "Kleinster", MAX(HOEHE )-MIN(HOEHE ) AS "Unterschied" <br />FROM BERG <br />GROUP BY ROLLUP(gebirge) &nbsp;&nbsp;&nbsp;&nbsp;ORDER BY COUNT(name) DESC<br />;<br /># ROLLUP GROUPING<br /># Jetzt keine Verwechslunksgefahr mehr durch bessere Benennung. (Vgl. Null-Werte)<br />SELECT GROUPING(GEBIRGE) AS "GROUPING(gebirge)" , <br />&nbsp;&nbsp;&nbsp;&nbsp;CASE GROUPING(gebirge) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 1 THEN \'(-alle Gebirge-)\' <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE gebirge <br />&nbsp;&nbsp;&nbsp;&nbsp;END &nbsp;&nbsp;&nbsp;&nbsp;AS "CASE"&nbsp;&nbsp;&nbsp;&nbsp;, <br />&nbsp;&nbsp;&nbsp;&nbsp;GEBIRGE , COUNT(name) AS "AnzahlBerge", MAX(HOEHE ) "Groester" ,MIN(HOEHE ) "Kleinster", <br />&nbsp;&nbsp;&nbsp;&nbsp;MAX(HOEHE )-MIN(HOEHE ) AS "Unterschied" <br />FROM BERG <br />GROUP BY ROLLUP(gebirge) &nbsp;&nbsp;&nbsp;&nbsp;ORDER BY COUNT(name) DESC<br />;<br /># DISTINCT mehrspaltik&lt;/u&gt;&lt;/b&gt;<br /># DISTINCT sorgt hier nur für einmalige Ergebniszeilen. Doppeltes wird gestrichen. <br /># Vgl. einmal den SELECT nur über die Spalte GEBIRGE<br />SELECT gebirge, name FROM BERG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY gebirge'<br /> </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'BERG' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br /><br /><br />#echo '&lt;br&gt;';<br /></font><font color="#0000BB">$t1 </font><font color="#007700">= </font><font color="#DD0000">"SELECT gebirge FROM berg &nbsp;&nbsp;&nbsp;&nbsp;WHERE gebirge &nbsp;&nbsp;&nbsp;&nbsp;BETWEEN 'r' AND 't' \n"</font><font color="#007700">;<br /></font><font color="#0000BB">$t2 </font><font color="#007700">= </font><font color="#DD0000">"\nSELECT gebirge FROM berg &nbsp;&nbsp;&nbsp;&nbsp;WHERE gebirge &nbsp;&nbsp;&nbsp;&nbsp;BETWEEN 's' AND 'u' <br />ORDER BY gebirge ASC"</font><font color="#007700">;<br /></font><font color="#FF8000">###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;br&gt;&lt;b&gt;&lt;u&gt;UNION(Vereinigung) INTERSECT(Schnittmenge) und EXCEPT(Minus)&lt;/u&gt;&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'T1 UNION T2<br />Vereinigung ohne doppelte Ergebnisse.<br />Erscheint z.B. Zeile A 3-mal in T1 und 2-mal in T2, erscheint sie nur 1-mal.' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">"<br /># T1 UNION T2<br /># Vereinigung ohne doppelte Ergebnisse.<br /># Erscheint z.B. Zeile A 3-mal in T1 und 2-mal in T2, erscheint sie nur 1-mal.<br />$t1 UNION $t2<br />;<br /># T1 UNION ALL T2<br /># Vereinigung. Erscheint z.B. Zeile A 3-mal in T1 und 2-mal in T2, erscheint sie sogar 5-mal.<br />$t1 UNION ALL $t2<br />;<br /># T1 INTERSECT T2<br /># Schnittmenge ohne doppelte Zeilen.<br />$t1 <br />INTERSECT <br />$t2<br />;<br /># T1 INTERSECT ALL T2<br /># Schnittmenge mit bei der kleinere Häufigkeit (wie bei UNION ALL) erhalten bleibt.<br />$t1 <br />INTERSECT ALL <br />$t2<br />;<br /># T2 EXCEPT T1<br /># Ergebnisse sind in T2, aber nicht in T1. Ohne doppelte Zeilen.<br />"</font><font color="#007700">.</font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">'ORDER BY gebirge ASC'</font><font color="#007700">,</font><font color="#DD0000">''</font><font color="#007700">,</font><font color="#0000BB">$t2</font><font color="#007700">).</font><font color="#DD0000">" EXCEPT $t1<br />;<br /># T1 EXCEPT T2<br /># Ergebnisse sind in T1, aber nicht in T2. Ohne doppelte Zeilen.<br />$t1 <br />EXCEPT <br />$t2<br />;<br /># T1 EXCEPT ALL T2<br /># Differenz. Erscheint z.B. Zeile A 3-mal in T1 und 2-mal in T2, erscheint sie genau 1-mal.<br />$t1 <br />EXCEPT ALL <br />$t2<br /><br />"<br /> </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'BERG' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />#echo '&lt;br&gt;';<br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;br&gt;&lt;b&gt;&lt;u&gt;LEFT|RIGHT|FULL OUTER JOIN&lt;/u&gt;&lt;/b&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Der "normale" JOIN wird implizit im folgenden verwendet.' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br />SELECT b.hoehe AS "b.hoehe", e.hoehe AS "e.hoehe" <br />FROM ebene AS e, berg AS b <br />WHERE CAST(e.hoehe/500 AS DECIMAL(9))&nbsp;&nbsp;= CAST(b.hoehe/500 AS DECIMAL(9))<br />;<br /># JOIN<br /># Hier wurde JOIN explizit verwendet. Das Ergebnis ist das selbe.<br />SELECT b.hoehe AS "b.hoehe", e.hoehe AS "e.hoehe" <br />FROM ebene AS e JOIN berg AS b<br />ON CAST(e.hoehe/500 AS DECIMAL(9))&nbsp;&nbsp;= CAST(b.hoehe/500 AS DECIMAL(9))<br />;<br /># LEFT OUTER JOIN<br /># Zusätzlich nun auch Zeilen linken Tabelle, welche die WHERE - Bedingung nicht erfüllen.<br />SELECT l.hoehe AS "left.hoehe" , b.hoehe AS "b.hoehe" <br />FROM ebene AS l LEFT OUTER JOIN berg AS b<br />ON CAST(l.hoehe/500 AS DECIMAL(9))&nbsp;&nbsp;= CAST(b.hoehe/500 AS DECIMAL(9)) <br />ORDER BY l.hoehe ASC<br />;<br /># RIGHT OUTER JOIN<br /># Zusätzlich nun auch Zeilen rechten Tabelle, <br /># welche die WHERE - Bedingung nicht erfüllen.<br />SELECT right.hoehe AS "right.hoehe", e.hoehe AS "e.hoehe" <br />FROM&nbsp;&nbsp;&nbsp;&nbsp;ebene AS e&nbsp;&nbsp;&nbsp;RIGHT OUTER JOIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;berg AS right<br />ON CAST(e.hoehe/500 AS DECIMAL(9))&nbsp;&nbsp;= CAST(right.hoehe/500 AS DECIMAL(9)) <br />ORDER BY e.hoehe ASC<br />;<br /># FULL OUTER JOIN<br /># Zusätzlich nun auch Zeilen beider Tabellen, welche die WHERE - Bedingung nicht erfüllen.<br />SELECT b.hoehe AS "b.hoehe", e.hoehe AS "e.hoehe" <br />FROM ebene AS e FULL OUTER JOIN berg AS b<br />ON CAST(e.hoehe/500 AS DECIMAL(9))&nbsp;&nbsp;= CAST(b.hoehe/500 AS DECIMAL(9)) <br />ORDER BY e.hoehe ASC<br />'&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'BERG' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />#echo '&lt;br&gt;';<br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;u&gt;Zufallszahlen - CREATE INSERT &lt;b&gt;WITH&lt;/b&gt;&lt;/u&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'Tabelle mit Zufallszahlen erstellen.' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br />CREATE TABLE zahlen(zähler Integer, zufall Integer)<br /># Tabelle ist erstellt<br />;<br />INSERT INTO zahlen(zähler, zufall) <br />&nbsp;&nbsp;&nbsp;&nbsp;WITH temporäre_Sicht(n) AS (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES(1) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNION ALL <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT n+1 FROM temporäre_Sicht WHERE n&lt;2 <br />&nbsp;&nbsp;&nbsp;&nbsp;) <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT n, integer(rand()*10) FROM temporäre_Sicht<br /># Das hier ist der interessante Teil gewesen.<br />;<br />SELECT * FROM zahlen;<br /># Man sieht es hat geklappt.<br />DROP TABLE zahlen;<br />'&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'zahlen' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br />###############################<br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;u&gt;2.3.4.2 &lt;b&gt;WITH&lt;/b&gt;&lt;/u&gt;' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'2.3.4.2<br />Geben Sie alle Paare von Ländern mit Meeresküste in Europa aus, die an die gleiche Menge von Meeren angrenzen.<br />Beispiel:<br />[Belgien, Niederlande]<br />da M_Belgien = M_Niederlande = {Nordsee}<br />[Belgien, Spanien] sollte nicht auftauchen,<br />da M_Spanien = {Atlantik, Mittelmeer}<br />' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br /># Alle Länder-Paare innerhalb Europa:<br />WITH europa (l_id, l_name) AS<br />( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l.l_id AS "l.l_id", l.name AS "l.name"&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land l, umfasst u, kontinent k <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;l.l_id = u.l_id&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;u.k_id = k.k_id&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;k.name = \'Europa\'<br />) <br />SELECT l1.name "l1.name", l2.name "l2.name" <br />&nbsp;&nbsp;&nbsp;&nbsp;FROM benachbart b, land l1, land l2 <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.l_id1 = l1.l_id AND b.l_id2 = l2.l_id<br />&nbsp;&nbsp;&nbsp;&nbsp;AND b.l_id1 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN (SELECT l_id FROM europa)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND b.l_id2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN (SELECT l_id FROM europa)<br /># ...57 Paare<br />;<br /># Zuordnung Land und Meer:<br /><br />WITH land_meer (l_id, name) AS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l.l_id, g.name <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land l, landesteil lt, geo_gewaesser gg, gewaesser g, meer m <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE l.l_id = lt.l_id<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND lt.lt_id = gg.lt_id<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND gg.g_id = g.g_id<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND g.g_id = m.g_id <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY l.l_id, g.name<br />) <br />SELECT l.name "l.name", m.name "m.name"<br />&nbsp;&nbsp;&nbsp;&nbsp;FROM land_meer m, land l <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE m.l_id = l.l_id<br /><br />;<br /># Eine mögliche Lösung:<br /><br />WITH europa (l_id, l_name) AS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l.l_id, l.name <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land l, umfasst u, kontinent k <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE l.l_id = u.l_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND u.k_id = k.k_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND k.name = \'Europa\'<br />), europa_paare (l_id1, l_id2) AS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id1, l_id2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM benachbart b <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.l_id1 IN ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id FROM europa <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)AND b.l_id2 IN (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT l_id FROM europa<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br />), land_meer (l_id, name) AS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT l.l_id, g.name <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land l, landesteil lt, geo_gewaesser gg, gewaesser g, meer m <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE l.l_id = lt.l_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND lt.lt_id = gg.lt_id<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND gg.g_id = g.g_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND g.g_id = m.g_id <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY l.l_id, g.name<br />) <br />SELECT l1.l_id "l1.l_id",&nbsp;&nbsp;l1.name "l1.name", l2.l_id "l2.l_id", l2.name "l2.name"<br />&nbsp;&nbsp;&nbsp;&nbsp;FROM land l1, land l2, europa_paare e <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE l1.l_id = e.l_id1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;l2.l_id = e.l_id2<br />&nbsp;&nbsp;&nbsp;&nbsp;AND NOT EXISTS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT m1.name FROM land_meer m1 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE m1.l_id = e.l_id1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPT ALL <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT m2.name FROM land_meer m2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE m2.l_id = e.l_id2<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;AND NOT EXISTS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT m3.name <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM land_meer m3 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE m3.l_id = e.l_id2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPT ALL <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT m4.name FROM land_meer m4 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE m4.l_id = e.l_id1<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;EXISTS ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT m5.name FROM land_meer m5 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE m5.l_id = e.l_id1<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />'&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'zahlen' </font><font color="#007700">);<br /></font><font color="#FF8000">###############################<br /><br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;u&gt;2.3.4.3.(a) &lt;b&gt;WITH&lt;/b&gt;&lt;/u&gt; billig von Kapstadt nach New York' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'2.3.4.3.(a)<br />Finden Sie die günstigste Flugverbindung von Kapstadt nach New York.' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br /># Theoretisch muss man alle möglichen Verbindungen durchrechnen, das ist bei einem rückgekoppelten Netz nicht möglich -&gt; <br /># Endlosschleife.<br /># Daher wird hier die Zahl der Umstiegen wird auf 5 gesetzt.<br /><br />WITH flug_ny ( flug_id, flug_strecke, fh_strecke, umstieg, abflugfh_id, ankunftfh_id, preis, sum_preis) AS (<br />&nbsp;&nbsp;&nbsp;&nbsp;( SELECT f.flug_id, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAST(CAST(f.flug_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAST(CAST(f.abflugfh_id AS char(3)) AS varchar(100)) || \'-&gt;\' || CAST(CAST(f.ankunftfh_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1, f.abflugfh_id, f.ankunftfh_id, f.preis, f.preis <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM flug f, flughafen fh, stadt s <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE f.abflugfh_id = fh.fh_id&nbsp;&nbsp;AND&nbsp;&nbsp;fh.s_id = s.s_id AND s.name = \'Kapstadt\'<br />&nbsp;&nbsp;&nbsp;&nbsp;) <br />&nbsp;&nbsp;&nbsp;&nbsp;UNION ALL <br />&nbsp;&nbsp;&nbsp;&nbsp;( SELECT f1.flug_id, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fny.flug_strecke || \'-&gt;\' || CAST(CAST(f1.flug_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fny.fh_strecke || \'-&gt;\' || CAST(CAST(f1.ankunftfh_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fny.umstieg+1, f1.abflugfh_id, f1.ankunftfh_id, f1.preis, f1.preis + fny.sum_preis <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM flug f1, flug_ny fny&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# , flughafen fh1, stadt s1 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE f1.abflugfh_id = fny.ankunftfh_id <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# _and f1.ankunftfh_id = fh1.fh_id AND fh1.s_id = s1.s_id AND s1.name = \'New_York\'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND umstieg &lt; 5<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />) <br />SELECT flug_strecke, fh_strecke, umstieg, code AS ankunft_fh, sum_preis AS gesamt_preis <br />&nbsp;&nbsp;&nbsp;&nbsp;FROM flug_ny fny2, flughafen fh2, stadt s2 <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;fny2.ankunftfh_id = fh2.fh_id AND fh2.s_id = s2.s_id AND s2.name = \'New_York\' <br />&nbsp;&nbsp;&nbsp;&nbsp;AND sum_preis = <br />&nbsp;&nbsp;&nbsp;&nbsp;( SELECT MIN(sum_preis) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM flug_ny fny2, flughafen fh2, stadt s2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;fny2.ankunftfh_id = fh2.fh_id AND fh2.s_id = s2.s_id AND s2.name = \'New_York\' <br />&nbsp;&nbsp;&nbsp;&nbsp;)<br /><br /><br /># FLUG_STRECKE&nbsp;&nbsp;&nbsp;&nbsp;FH_STRECKE&nbsp;&nbsp;&nbsp;&nbsp;UMSTIEG&nbsp;&nbsp;&nbsp;&nbsp;ANKUNFT_FH&nbsp;&nbsp;&nbsp;&nbsp;GESAMT_PREIS<br /># 34 -&gt;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&gt;2&nbsp;&nbsp;-&gt;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;JFK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1673.00<br /><br />'&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'zahlen' </font><font color="#007700">);<br /><br /></font><font color="#0000BB">$aufgaben_list</font><font color="#007700">[] = array( </font><font color="#0000BB">nr </font><font color="#007700">=&gt;&nbsp;&nbsp;</font><font color="#DD0000">'&lt;u&gt;2.3.4.3.(b) &lt;b&gt;WITH&lt;/b&gt;&lt;/u&gt; wenig Umstiege von Frankfurt nach Los Angeles' </font><font color="#007700">, <br /></font><font color="#0000BB">text </font><font color="#007700">=&gt;</font><font color="#DD0000">'2.3.4.3.(b)<br />Finden Sie die Verbindung von Frankfurt nach Los Angeles mit den wenigsten<br />Umstiegen. Falls mehrere Alternativen bestehen, wählen Sie die günstigste.' </font><font color="#007700">,<br /></font><font color="#0000BB">sql </font><font color="#007700">=&gt; </font><font color="#DD0000">'<br /># Die Abbruchbedingung aus der Rekursion kann man hier direkt angaben, da hier die Verbindung mit den wenigsten Umstiegen gesucht wird. <br /><br />WITH flug_ny ( flug_id, flug_strecke, fh_strecke, umstieg, abflugfh_id, ankunftfh_id, preis, sum_preis) AS (<br />( &nbsp;&nbsp;&nbsp;&nbsp;SELECT f.flug_id, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAST(CAST(f.flug_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAST(CAST(f.abflugfh_id AS char(3)) AS varchar(100)) || \'-&gt;\' <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| CAST(CAST(f.ankunftfh_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1, f.abflugfh_id, f.ankunftfh_id, f.preis, f.preis <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM flug f, flughafen fh, stadt s <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE f.abflugfh_id = fh.fh_id AND fh.s_id = s.s_id AND s.name = \'Frankfurt\'<br />&nbsp;&nbsp;&nbsp;&nbsp;) <br />&nbsp;&nbsp;&nbsp;&nbsp;UNION ALL ( <br />&nbsp;&nbsp;&nbsp;&nbsp;SELECT f1.flug_id, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fny.flug_strecke || \'-&gt;\' || CAST(CAST(f1.flug_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fny.fh_strecke || \'-&gt;\' || CAST(CAST(f1.ankunftfh_id AS char(3)) AS varchar(100)), <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fny.umstieg+1, f1.abflugfh_id, f1.ankunftfh_id, f1.preis, f1.preis + fny.sum_preis <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM flug f1, flug_ny fny, flughafen fh1, stadt s1 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE f1.abflugfh_id = fny.ankunftfh_id <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND f1.ankunftfh_id = fh1.fh_id AND fh1.s_id = s1.s_id AND s1.name = \'Los_Angeles\'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#AND umstieg &lt; 5 */<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br />) <br />SELECT flug_strecke, fh_strecke, umstieg, code AS ankunft_fh, sum_preis AS gesamt_preis <br />&nbsp;&nbsp;&nbsp;&nbsp;FROM flug_ny fny2, flughafen fh2, stadt s2 <br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;fny2.ankunftfh_id = fh2.fh_id AND fh2.s_id = s2.s_id AND s2.name = \'Los_Angeles\' <br />&nbsp;&nbsp;&nbsp;&nbsp;AND sum_preis = ( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT MIN(sum_preis) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM flug_ny fny2, flughafen fh2, stadt s2 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;fny2.ankunftfh_id = fh2.fh_id AND fh2.s_id = s2.s_id AND s2.name = \'Los_Angeles\' <br />)<br /><br /># FLUG_STRECKE&nbsp;&nbsp;&nbsp;&nbsp;FH_STRECKE&nbsp;&nbsp;&nbsp;&nbsp;UMSTIEG&nbsp;&nbsp;&nbsp;&nbsp;ANKUNFT_FH&nbsp;&nbsp;&nbsp;&nbsp;GESAMT_PREIS<br /># 7&nbsp;&nbsp;-&gt;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;-&gt;3&nbsp;&nbsp;-&gt;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;LAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1920.00<br /><br />'&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#007700">, </font><font color="#0000BB">tbl </font><font color="#007700">=&gt; </font><font color="#DD0000">'zahlen' </font><font color="#007700">);<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></font><font color="#FF8000">##echo '&lt;pre&gt;'; var_export($aufgaben_list); #echo '/&lt;pre&gt;';<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></li>
</ol><input size=1 name="bottom" style="font: 1%;">
</form></body></html>

